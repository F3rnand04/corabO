(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8220],{97655:function(e,t,s){Promise.resolve().then(s.bind(s,7512))},7512:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return I}});var a=s(57437),i=s(2265),n=s(12381),r=s(79820),l=s(60610),c=s(93448);let o=i.forwardRef((e,t)=>{let{className:s,value:i,...n}=e;return(0,a.jsx)(l.fC,{ref:t,className:(0,c.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...n,children:(0,a.jsx)(l.z$,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(i||0),"%)")}})})});o.displayName=l.fC.displayName;var d=s(70061),u=s(92451),m=s(99637),x=s(91804),p=s(98728),h=s(51817),f=s(86595),v=s(31047),j=s(45554),y=s(65621),g=s(12527),b=s(16275),N=s(99376),C=s(6942),w=s(68946);function P(e){let{title:t,transactions:s,onTransactionClick:i}=e,{currentUser:n,users:l}=(0,d.a)();return(0,a.jsxs)(r.Zb,{children:[(0,a.jsx)(r.Ol,{children:(0,a.jsx)(r.ll,{children:t})}),(0,a.jsx)(r.aY,{children:s.length>0?(0,a.jsx)("div",{className:"space-y-2",children:s.map(e=>{if(!n)return null;let t=e.providerId===n.id?e.clientId:e.providerId,s=l.find(e=>e.id===t)||null;return(0,a.jsx)(w.A,{transaction:e,otherParty:s,onClick:i},e.id)})}):(0,a.jsx)("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No hay transacciones en esta vista."})})]})}var Z=s(67135),k=s(92213),z=s(27648),S=s(63146),T=s(12749),_=s(46291),E=s(29750),A=s(56710),D=s(16717);function L(e){let{onBackToSummary:t,currentView:s}=e,i=(0,N.useRouter)();return(0,a.jsx)("header",{className:"sticky top-0 z-30 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 border-b",children:(0,a.jsx)("div",{className:"container px-4 sm:px-6",children:(0,a.jsxs)("div",{className:"flex h-16 items-center justify-between",children:[(0,a.jsx)(n.z,{variant:"ghost",size:"icon",onClick:()=>"summary"!==s?t():i.push("/"),children:"summary"!==s?(0,a.jsx)(u.Z,{className:"h-6 w-6"}):(0,a.jsx)(m.Z,{className:"h-6 w-6"})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(x.Z,{className:"h-6 h-6 text-muted-foreground"}),(0,a.jsx)("h1",{className:"text-lg font-semibold",children:"Registro de Transacciones"})]}),(0,a.jsx)(n.z,{variant:"ghost",size:"icon",onClick:()=>i.push("/transactions/settings"),children:(0,a.jsx)(p.Z,{className:"h-6 w-6 text-muted-foreground"})})]})})})}let R=e=>{let{icon:t,label:s,count:i,onClick:r}=e;return(0,a.jsxs)(n.z,{variant:"outline",className:"flex flex-col h-24 w-full items-center justify-center gap-1 relative",onClick:r,children:[i>0&&(0,a.jsx)("span",{className:"absolute top-2 right-2 flex h-5 w-5 items-center justify-center rounded-full bg-primary text-primary-foreground text-xs",children:i}),(0,a.jsx)(t,{className:"w-8 h-8 text-primary"}),(0,a.jsx)("span",{className:"text-xs text-center",children:s})]})};function I(){var e;let{currentUser:t,transactions:s,cart:l,getUserMetrics:c,isLoadingAuth:u}=(0,d.a)(),m=(0,N.useRouter)(),[p,w]=(0,i.useState)(null),[I,O]=(0,i.useState)(!1),[F,M]=(0,i.useState)("summary"),[Y,$]=(0,i.useState)(!1),q=null!==(e=null==t?void 0:t.isTransactionsActive)&&void 0!==e&&e,{agendaEvents:V,paymentDates:H,totalCartItems:J,pendingTx:B,historyTx:U,commitmentTx:W,reputation:X,effectiveness:Q,credicoraLevelDetails:G,nextCredicoraLevelDetails:K,completedTransactionsCount:ee,transactionsNeeded:et,progressToNextLevel:es}=(0,i.useMemo)(()=>{var e,a;if(!t)return{agendaEvents:[],paymentDates:[],totalCartItems:0,pendingTx:[],historyTx:[],commitmentTx:[],reputation:0,effectiveness:0,credicoraLevelDetails:null,nextCredicoraLevelDetails:null,completedTransactionsCount:0,transactionsNeeded:1,progressToNextLevel:0};let i=(null===(e=t.profileSetupData)||void 0===e?void 0:e.providerType)==="company"?k.Jw:k.vl,n=c(t.id,t.type,s),r=s.filter(e=>["Finalizado - Pendiente de Pago","Cita Solicitada"].includes(e.status)).map(e=>({date:new Date(e.date),type:"Finalizado - Pendiente de Pago"===e.status?"payment":"appointment",transactionId:e.id})),o=r.filter(e=>"payment"===e.type).map(e=>e.date),d=l.reduce((e,t)=>e+t.quantity,0),u=s.filter(e=>"provider"===t.type?e.providerId===t.id&&["Solicitud Pendiente","Acuerdo Aceptado - Pendiente de Ejecuci\xf3n","Cita Solicitada","Pago Enviado - Esperando Confirmaci\xf3n"].includes(e.status):e.clientId===t.id&&["Cotizaci\xf3n Recibida","Finalizado - Pendiente de Pago","Pendiente de Confirmaci\xf3n del Cliente"].includes(e.status)),m=s.filter(e=>["Pagado","Resuelto"].includes(e.status)),x=s.filter(e=>["Acuerdo Aceptado - Pendiente de Ejecuci\xf3n","Finalizado - Pendiente de Pago"].includes(e.status)),p=i[(t.credicoraLevel||1).toString()],h=i[((t.credicoraLevel||1)+1).toString()],f=s.filter(e=>e.clientId===t.id&&["Pagado","Resuelto"].includes(e.status)).length,v=null!==(a=null==p?void 0:p.transactionsForNextLevel)&&void 0!==a?a:1;return{agendaEvents:r,paymentDates:o,totalCartItems:d,pendingTx:u,historyTx:m,commitmentTx:x,reputation:n.reputation,effectiveness:n.effectiveness,credicoraLevelDetails:p,nextCredicoraLevelDetails:h,completedTransactionsCount:f,transactionsNeeded:v,progressToNextLevel:f/v*100}},[t,s,l,c]);if(u||!t)return(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsx)(h.Z,{className:"h-12 w-12 animate-spin text-primary"})});let ea=e=>{let t=V.find(t=>(0,E.WU)(t.date,"yyyy-MM-dd")===(0,E.WU)(e,"yyyy-MM-dd"));if(t){let e=s.find(e=>e.id===t.transactionId);e&&w(e)}};return(0,a.jsxs)("div",{className:"bg-muted/20 min-h-screen",children:[(0,a.jsx)(L,{onBackToSummary:()=>M("summary"),currentView:F}),(0,a.jsx)("main",{className:"container py-6",children:q?(()=>{switch(F){case"pending":return(0,a.jsx)(P,{title:"Lista de Pendientes",transactions:B,onTransactionClick:w});case"history":return(0,a.jsx)(P,{title:"Historial de Transacciones",transactions:U,onTransactionClick:w});case"commitments":return(0,a.jsx)(P,{title:"Compromisos de Pago",transactions:W,onTransactionClick:w});default:return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(r.Zb,{children:[(0,a.jsxs)(r.Ol,{children:[(0,a.jsxs)(r.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(f.Z,{className:"w-6 h-6 text-blue-500 fill-blue-500"}),"Mi Credicora"]}),(0,a.jsx)(r.SZ,{children:"Tu motor de crecimiento en Corabo."})]}),(0,a.jsxs)(r.aY,{className:"space-y-4",children:[G&&(0,a.jsx)("div",{className:"space-y-1",children:(0,a.jsxs)("div",{className:"flex justify-between items-baseline text-sm font-medium",children:[(0,a.jsxs)("span",{className:"text-muted-foreground",children:["Nivel ",G.level]}),(0,a.jsx)("span",{className:"font-bold text-lg text-foreground",children:G.name})]})}),G&&(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex justify-between text-xs font-medium",children:[(0,a.jsx)("span",{children:"L\xedmite de Cr\xe9dito"}),(0,a.jsxs)("span",{children:["$",(t.credicoraLimit||0).toLocaleString()," / $",G.creditLimit.toLocaleString()]})]}),(0,a.jsx)(o,{value:(t.credicoraLimit||0)/G.creditLimit*100,className:"h-2 [&>div]:bg-blue-500"})]}),K&&(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex justify-between text-xs font-medium",children:[(0,a.jsxs)("span",{children:["Pr\xf3ximo Nivel: ",K.name]}),(0,a.jsxs)("span",{children:[ee," / ",et," transacciones"]})]}),(0,a.jsx)(o,{value:es,className:"h-2"})]}),(0,a.jsx)("div",{className:"text-right",children:(0,a.jsx)(n.z,{variant:"link",size:"sm",asChild:!0,className:"text-xs p-0 h-auto",children:(0,a.jsx)(z.default,{href:"/credicora",children:"Saber m\xe1s"})})})]})]}),(0,a.jsxs)(r.Zb,{children:[(0,a.jsx)(r.Ol,{children:(0,a.jsxs)(r.ll,{className:"text-lg flex justify-between items-center",children:[(0,a.jsx)("span",{children:"Mi Reputaci\xf3n"}),(0,a.jsxs)(T.J2,{children:[(0,a.jsx)(T.xo,{asChild:!0,children:(0,a.jsxs)(n.z,{variant:"outline",size:"sm",children:[(0,a.jsx)(v.Z,{className:"mr-2 h-4 w-4 text-blue-600"}),"Ver Pagos"]})}),(0,a.jsxs)(T.yk,{className:"w-auto p-0",children:[(0,a.jsx)(_.f,{mode:"multiple",selected:H,onDayClick:ea}),(0,a.jsx)("div",{className:"p-2 border-t text-center text-xs text-muted-foreground",children:"Haz clic en una fecha para ver el detalle del pago."})]})]})]})}),(0,a.jsx)(r.aY,{children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex justify-between text-xs font-medium",children:[(0,a.jsx)("span",{children:"Reputaci\xf3n (Estrellas)"}),(0,a.jsxs)("span",{children:[X.toFixed(1),"/5.0"]})]}),(0,a.jsx)(o,{value:X/5*100,className:"h-2"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex justify-between text-xs font-medium",children:[(0,a.jsx)("span",{children:"Efectividad"}),(0,a.jsxs)("span",{children:[Q.toFixed(0),"%"]})]}),(0,a.jsx)(o,{value:Q,className:"h-2"})]})]})})]}),(0,a.jsx)(r.Zb,{children:(0,a.jsx)(r.aY,{className:"p-2",children:(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-2",children:[(0,a.jsx)(R,{icon:j.Z,label:"Pendientes",count:B.length,onClick:()=>M("pending")}),(0,a.jsx)(R,{icon:y.Z,label:"Historial",count:0,onClick:()=>M("history")}),(0,a.jsx)(R,{icon:g.Z,label:"Compromisos",count:W.length,onClick:()=>M("commitments")}),(0,a.jsxs)(T.J2,{children:[(0,a.jsx)(T.xo,{asChild:!0,children:(0,a.jsxs)(n.z,{variant:"outline",className:"flex flex-col h-24 w-full items-center justify-center gap-1 relative",children:[J>0&&(0,a.jsx)("span",{className:"absolute top-2 right-2 flex h-5 w-5 items-center justify-center rounded-full bg-primary text-primary-foreground text-xs",children:J}),(0,a.jsx)(b.Z,{className:"w-8 h-8 text-primary"}),(0,a.jsx)("span",{className:"text-xs text-center",children:"Carrito"})]})}),(0,a.jsx)(T.yk,{className:"w-80",children:(0,a.jsx)(D.P,{onCheckoutClick:()=>$(!0)})})]})]})})}),!t.isSubscribed&&(0,a.jsx)(r.Zb,{className:"bg-gradient-to-r from-primary/10 to-blue-500/10 border-primary/20",children:(0,a.jsxs)(r.aY,{className:"p-6 text-center",children:[(0,a.jsx)("div",{className:"mx-auto bg-primary/20 text-primary w-12 h-12 rounded-full flex items-center justify-center mb-4",children:(0,a.jsx)(f.Z,{className:"w-6 h-6"})}),(0,a.jsx)("h3",{className:"text-xl font-bold",children:"\xa1Desbloquea tu Potencial!"}),(0,a.jsx)("p",{className:"text-muted-foreground mt-2 mb-4",children:"Obt\xe9n tu insignia de verificado, llega a m\xe1s clientes y accede a beneficios exclusivos."}),(0,a.jsx)(n.z,{onClick:()=>O(!0),children:"Ver Planes de Suscripci\xf3n"})]})})]})}})():(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(Z.u,{userType:t.type}),(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(x.Z,{className:"mx-auto h-16 w-16 text-muted-foreground"}),(0,a.jsx)("h2",{className:"mt-4 text-2xl font-semibold",children:"M\xf3dulo Desactivado"}),(0,a.jsx)("p",{className:"mt-2 text-muted-foreground",children:"Activa el m\xf3dulo para ver tus finanzas."}),(0,a.jsx)(n.z,{className:"mt-4",onClick:()=>m.push("/transactions/settings"),children:"Activar M\xf3dulo"})]})]})}),(0,a.jsx)(C.m,{isOpen:!!p,onOpenChange:()=>w(null),transaction:p}),(0,a.jsx)(S.B,{isOpen:I,onOpenChange:O}),(0,a.jsx)(A.z,{onOpenChange:$})]})}},67135:function(e,t,s){"use strict";s.d(t,{u:function(){return d}});var a=s(57437),i=s(95937),n=s(12381),r=s(70061),l=s(69076),c=s(49322),o=s(99376);function d(e){let{userType:t}=e,{currentUser:s}=(0,r.a)(),d=(0,o.useRouter)();if(!s)return null;let u=null==s?void 0:s.isPaused,m={client:{title:"\xa1Activa tu registro!",description:"Disfruta de compras seguras y con seguimiento.",buttonText:"Activar ahora"},provider:{title:"\xa1Activa tu registro!",description:"Empieza a recibir pagos y a gestionar tus ingresos de forma segura.",buttonText:"Activar ahora"},repartidor:{title:"\xa1Activa tu registro!",description:"Completa tu perfil para poder aceptar entregas.",buttonText:"Activar ahora"}},{title:x,description:p,buttonText:h}=u?{title:"\xa1Tu cuenta est\xe1 en pausa!",description:"Debido a inactividad, algunas funciones han sido desactivadas. Act\xedvalas de nuevo.",buttonText:"Reactivar Registro"}:m[t]||m.client,f=u?l.Z:c.Z;return(0,a.jsxs)(i.bZ,{children:[(0,a.jsx)(f,{className:"h-4 w-4"}),(0,a.jsx)(i.Cd,{className:"font-semibold",children:x}),(0,a.jsxs)(i.X,{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{children:p}),(0,a.jsxs)(n.z,{variant:"link",size:"sm",onClick:()=>{var e,t;if(s.isPaused){d.push("/transactions/settings");return}if((null===(e=s.profileSetupData)||void 0===e?void 0:e.providerType)==="company"&&!(null===(t=s.profileSetupData)||void 0===t?void 0:t.specialty)){d.push("/profile-setup");return}s.isInitialSetupComplete?"verified"!==s.idVerificationStatus?d.push("/profile-setup/verify-id"):d.push("/transactions/settings"):d.push("/profile-setup")},className:"p-0 h-auto text-current font-bold",children:[h," â†’"]})]})]})}},68946:function(e,t,s){"use strict";s.d(t,{A:function(){return v}});var a=s(57437),i=s(96246),n=s(69174),r=s(93448),l=s(53417),c=s(44743),o=s(4948),d=s(83578),u=s(41671),m=s(76865),x=s(45575),p=s(43681),h=s(40340);let f={"Solicitud Pendiente":{icon:l.Z,color:"text-yellow-500",label:"Pendiente"},"Cotizaci\xf3n Recibida":{icon:c.Z,color:"text-blue-500",label:"Cotizado"},"Acuerdo Aceptado - Pendiente de Ejecuci\xf3n":{icon:o.Z,color:"text-cyan-500",label:"Acordado"},"Servicio en Curso":{icon:o.Z,color:"text-blue-500",label:"En Curso"},"En Disputa":{icon:d.Z,color:"text-red-500",label:"Disputa"},Pagado:{icon:u.Z,color:"text-green-500",label:"Pagado"},Resuelto:{icon:u.Z,color:"text-green-500",label:"Resuelto"},"Carrito Activo":{icon:m.Z,color:"text-gray-500",label:"En Carrito"},"Pre-factura Pendiente":{icon:m.Z,color:"text-gray-500",label:"Pre-factura"},"Finalizado - Pendiente de Pago":{icon:x.Z,color:"text-orange-500",label:"Por Pagar"},"Pendiente de Confirmaci\xf3n del Cliente":{icon:x.Z,color:"text-yellow-600",label:"Por Confirmar"},"Pago Enviado - Esperando Confirmaci\xf3n":{icon:p.Z,color:"text-blue-500",label:"Pago Enviado"},"En Reparto":{icon:h.Z,color:"text-blue-500",label:"En Reparto"}},v=e=>{var t,s,l,c,o;let{transaction:d,otherParty:u,onClick:x}=e,p=(null===(t=f[d.status])||void 0===t?void 0:t.icon)||m.Z,h=(null===(s=f[d.status])||void 0===s?void 0:s.color)||"text-gray-500",v="",j="";if("Sistema"===d.type&&d.details.system){let e=d.details.system.match(/Cuota (\d+)\/(\d+)/);if(e){let t=parseInt(e[1],10),s=parseInt(e[2],10);j=t===s?"\xdaltima Cuota":"Cuota ".concat(t,"/").concat(s),v=d.details.system.replace(/Cuota \d+\/\d+ de /,"")}else v=d.details.system}else"credicora"===d.details.paymentMethod&&d.details.initialPayment?(j="Inicial de Compra",v=d.details.serviceName||(null===(c=d.details.items)||void 0===c?void 0:c.map(e=>e.product.name).join(", "))||""):v="Servicio"===d.type?d.details.serviceName||"Servicio sin nombre":"Compra"===d.type||"Compra Directa"===d.type?(null===(o=d.details.items)||void 0===o?void 0:o.map(e=>"".concat(e.quantity,"x ").concat(e.product.name)).join(", "))||d.details.system||"Compra sin detalle":"Transacci\xf3n del sistema";return(0,a.jsxs)("div",{className:"flex items-center gap-4 p-3 hover:bg-muted/50 rounded-lg cursor-pointer",onClick:()=>x(d),children:[(0,a.jsxs)(i.qE,{className:"h-10 w-10",children:[(0,a.jsx)(i.F$,{src:null==u?void 0:u.profileImage,alt:null==u?void 0:u.name}),(0,a.jsx)(i.Q5,{children:(null==u?void 0:u.name.charAt(0))||"S"})]}),(0,a.jsxs)("div",{className:"flex-grow",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("p",{className:"font-semibold text-sm",children:(null==u?void 0:u.name)||"Sistema"}),d.details.paymentFromThirdParty&&(0,a.jsx)(n.C,{variant:"destructive",className:"h-5 text-xs",children:"!"})]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground truncate max-w-[200px]",children:[j&&(0,a.jsxs)("span",{className:"font-bold text-foreground",children:[j,": "]}),v]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"font-bold text-sm",children:["$",d.amount.toFixed(2)]}),(0,a.jsxs)("div",{className:(0,r.cn)("flex items-center justify-end gap-1 text-xs font-semibold",h),children:[(0,a.jsx)(p,{className:"w-3 h-3"}),(0,a.jsx)("span",{children:(null===(l=f[d.status])||void 0===l?void 0:l.label)||d.status})]})]})]})}},46291:function(e,t,s){"use strict";s.d(t,{f:function(){return l}});var a=s(57437);s(2265);var i=s(29631),n=s(93448),r=s(12381);function l(e){let{className:t,classNames:s,showOutsideDays:l=!0,...c}=e;return(0,a.jsx)(i._,{showOutsideDays:l,className:(0,n.cn)("p-3",t),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,n.cn)((0,r.d)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,n.cn)((0,r.d)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...s},...c})}l.displayName="Calendar"}},function(e){e.O(0,[3609,9015,7337,2505,3125,2522,2939,7514,3145,7648,9027,6195,6239,2859,7845,9939,7213,5740,1636,7738,803,422,3146,2092,2971,2117,1744],function(){return e(e.s=97655)}),_N_E=e.O()}]);