"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[729],{60729:function(e,l,s){s.d(l,{L:function(){return D}});var a=s(57437),r=s(33145),t=s(74291),n=s(12381),i=s(90641),c=s(32489),o=s(15868),d=s(18930),u=s(50733),f=s(30401),h=s(53417),m=s(31810),x=s(37157),j=s(44743),p=s(40279),v=s(96246),N=s(31593),b=s(70061),w=s(2265),g=s(9467),y=s(32660),C=s(76858),k=s(93448);let z=w.createContext(null);function S(){let e=w.useContext(z);if(!e)throw Error("useCarousel must be used within a <Carousel />");return e}let Z=w.forwardRef((e,l)=>{let{orientation:s="horizontal",opts:r,setApi:t,plugins:n,className:i,children:c,...o}=e,[d,u]=(0,g.Z)({...r,axis:"horizontal"===s?"x":"y"},n),[f,h]=w.useState(!1),[m,x]=w.useState(!1),j=w.useCallback(e=>{e&&(h(e.canScrollPrev()),x(e.canScrollNext()))},[]),p=w.useCallback(()=>{null==u||u.scrollPrev()},[u]),v=w.useCallback(()=>{null==u||u.scrollNext()},[u]),N=w.useCallback(e=>{"ArrowLeft"===e.key?(e.preventDefault(),p()):"ArrowRight"===e.key&&(e.preventDefault(),v())},[p,v]);return w.useEffect(()=>{u&&t&&t(u)},[u,t]),w.useEffect(()=>{if(u)return j(u),u.on("reInit",j),u.on("select",j),()=>{null==u||u.off("select",j)}},[u,j]),(0,a.jsx)(z.Provider,{value:{carouselRef:d,api:u,opts:r,orientation:s,scrollPrev:p,scrollNext:v,canScrollPrev:f,canScrollNext:m},children:(0,a.jsx)("div",{ref:l,onKeyDownCapture:N,className:(0,k.cn)("relative",i),role:"region","aria-roledescription":"carousel",...o,children:c})})});Z.displayName="Carousel";let E=w.forwardRef((e,l)=>{let{className:s,...r}=e,{carouselRef:t,orientation:n}=S();return(0,a.jsx)("div",{ref:t,className:"overflow-hidden",children:(0,a.jsx)("div",{ref:l,className:(0,k.cn)("flex","horizontal"===n?"-ml-4":"-mt-4 flex-col",s),...r})})});E.displayName="CarouselContent";let I=w.forwardRef((e,l)=>{let{className:s,...r}=e,{orientation:t}=S();return(0,a.jsx)("div",{ref:l,role:"group","aria-roledescription":"slide",className:(0,k.cn)("min-w-0 shrink-0 grow-0 basis-full","horizontal"===t?"pl-4":"pt-4",s),...r})});I.displayName="CarouselItem";let R=w.forwardRef((e,l)=>{let{className:s,variant:r="outline",size:t="icon",...i}=e,{orientation:c,scrollPrev:o,canScrollPrev:d}=S();return(0,a.jsxs)(n.z,{ref:l,variant:r,size:t,className:(0,k.cn)("absolute  h-8 w-8 rounded-full","horizontal"===c?"-left-12 top-1/2 -translate-y-1/2":"-top-12 left-1/2 -translate-x-1/2 rotate-90",s),disabled:!d,onClick:o,...i,children:[(0,a.jsx)(y.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Previous slide"})]})});R.displayName="CarouselPrevious";let $=w.forwardRef((e,l)=>{let{className:s,variant:r="outline",size:t="icon",...i}=e,{orientation:c,scrollNext:o,canScrollNext:d}=S();return(0,a.jsxs)(n.z,{ref:l,variant:r,size:t,className:(0,k.cn)("absolute h-8 w-8 rounded-full","horizontal"===c?"-right-12 top-1/2 -translate-y-1/2":"-bottom-12 left-1/2 -translate-x-1/2 rotate-90",s),disabled:!d,onClick:o,...i,children:[(0,a.jsx)(C.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Next slide"})]})});$.displayName="CarouselNext";var A=s(23675),P=s(33507);function D(e){var l,s,g;let{isOpen:y,onOpenChange:C,gallery:k,startIndex:z=0,owner:S}=e,{currentUser:D}=(0,b.a)(),[F,_]=(0,w.useState)(),[q,T]=(0,w.useState)(z),[K,L]=(0,w.useState)(""),Q=(0,w.useRef)(null),[U,V]=(0,w.useState)(!1),[G,M]=(0,w.useState)(""),[O,B]=(0,w.useState)(null),[H,J]=(0,w.useState)(null),W=(null==D?void 0:D.id)===(null==S?void 0:S.id),X=k[q];(0,w.useEffect)(()=>{y?(M((null==X?void 0:X.description)||""),J(null),B(null)):(T(z),V(!1))},[y,z,X]),(0,w.useEffect)(()=>{if(!F)return;F.selectedScrollSnap()!==q&&F.scrollTo(q,!0);let e=()=>{T(F.selectedScrollSnap()),V(!1)};return F.on("select",e),()=>{F.off("select",e)}},[F,q]);let Y=()=>{K.trim()&&X&&S&&D&&((0,P.Ck)({ownerId:S.id,imageId:X.id,commentText:K,author:{id:D.id,name:D.name,profileImage:D.profileImage}}),L(""))},ee=e=>{X&&S&&D&&(0,P.nd)({imageId:X.id,commentIndex:e,authorId:D.id})},el=e=>{S&&D&&((0,P.yT)(S.id,e),C(!1))};return k&&0!==k.length&&D?(0,a.jsx)(t.Vq,{open:y,onOpenChange:C,children:(0,a.jsxs)(t.cZ,{className:"max-w-4xl w-[95vw] h-[90vh] flex flex-col p-0 gap-0",children:[(0,a.jsx)(t.fK,{children:(0,a.jsx)(t.$N,{className:"sr-only",children:null==X?void 0:X.alt})}),(0,a.jsx)(n.z,{variant:"ghost",size:"icon",onClick:()=>C(!1),className:"absolute top-2 right-2 z-50 bg-black/30 text-white hover:bg-black/50 hover:text-white rounded-full",children:(0,a.jsx)(c.Z,{className:"h-5 w-5"})}),(0,a.jsx)("div",{className:"w-full h-3/5 bg-black flex-shrink-0 relative",children:(0,a.jsxs)(Z,{setApi:_,className:"w-full h-full",children:[(0,a.jsx)(E,{children:k.map((e,l)=>(0,a.jsx)(I,{children:(0,a.jsx)("div",{className:"w-full h-full relative",children:"video"===e.type?(0,a.jsx)("video",{src:e.src,className:"w-full h-full object-contain",controls:!0,autoPlay:!0,loop:!0}):(0,a.jsx)(r.default,{src:H||e.src,alt:e.alt,fill:!0,className:"object-contain","data-ai-hint":"product detail"})})},l))}),(0,a.jsx)(R,{className:"absolute left-4 top-1/2 -translate-y-1/2 z-10"}),(0,a.jsx)($,{className:"absolute right-4 top-1/2 -translate-y-1/2 z-10"})]})}),(0,a.jsx)(i.x,{className:"flex-grow overflow-y-auto bg-background",children:X&&(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold",children:X.alt}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:["Publicado por ",(0,a.jsx)("span",{className:"font-semibold text-foreground",children:null==S?void 0:S.name})]})]}),W&&!U&&(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(n.z,{variant:"outline",size:"sm",onClick:()=>V(!0),children:[(0,a.jsx)(o.Z,{className:"h-4 w-4 mr-2"}),"Editar"]}),(0,a.jsxs)(n.z,{variant:"destructive",size:"sm",onClick:()=>el(X.id),children:[(0,a.jsx)(d.Z,{className:"h-4 w-4 mr-2"}),"Eliminar"]})]})]}),U?(0,a.jsxs)("div",{className:"my-4 space-y-4",children:[(0,a.jsx)("input",{type:"file",ref:Q,onChange:e=>{var l;let s=null===(l=e.target.files)||void 0===l?void 0:l[0];if(s){B(s);let e=new FileReader;e.onloadend=()=>J(e.result),e.readAsDataURL(s)}},className:"hidden",accept:"image/*,video/*"}),(0,a.jsxs)(n.z,{variant:"outline",className:"w-full",onClick:()=>{var e;return null===(e=Q.current)||void 0===e?void 0:e.click()},children:[(0,a.jsx)(u.Z,{className:"mr-2 h-4 w-4"}),"Cambiar Imagen o Video"]}),(0,a.jsx)(A.g,{value:G,onChange:e=>M(e.target.value),rows:4,placeholder:"Edita la descripci\xf3n..."}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(n.z,{variant:"ghost",onClick:()=>V(!1),children:"Cancelar"}),(0,a.jsxs)(n.z,{onClick:()=>{X&&S&&((0,P.Fn)(X.id,{description:G,imageDataUri:H||void 0}),V(!1))},children:[(0,a.jsx)(f.Z,{className:"mr-2 h-4 w-4"}),"Guardar Cambios"]})]})]}):(0,a.jsx)("p",{className:"text-sm text-foreground my-4",children:X.description}),(0,a.jsx)(N.Z,{}),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[(0,a.jsx)(h.Z,{className:"w-5 h-5"}),"Comentarios (",(null===(l=X.comments)||void 0===l?void 0:l.length)||0,")"]}),(0,a.jsxs)("div",{className:"space-y-4",children:[null===(s=X.comments)||void 0===s?void 0:s.map((e,l)=>(0,a.jsxs)("div",{className:"flex items-start gap-3 group",children:[(0,a.jsxs)(v.qE,{className:"w-8 h-8 shrink-0",children:[(0,a.jsx)(v.F$,{src:e.profileImage,alt:e.author}),(0,a.jsx)(v.Q5,{children:e.author.charAt(0)})]}),(0,a.jsxs)("div",{className:"flex-grow",children:[(0,a.jsx)("p",{className:"font-semibold text-sm",children:e.author}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:e.text}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-1 text-muted-foreground",children:[(0,a.jsx)(n.z,{variant:"ghost",size:"icon",className:"w-6 h-6",children:(0,a.jsx)(m.Z,{className:"w-4 h-4"})}),(0,a.jsx)("span",{className:"text-xs",children:0}),(0,a.jsx)(n.z,{variant:"ghost",size:"icon",className:"w-6 h-6",children:(0,a.jsx)(x.Z,{className:"w-4 h-4"})}),(0,a.jsx)("span",{className:"text-xs",children:0})]})]}),(e.authorId===D.id||W)&&(0,a.jsx)(n.z,{variant:"ghost",size:"icon",className:"w-7 h-7 shrink-0 opacity-0 group-hover:opacity-100",onClick:()=>ee(l),children:(0,a.jsx)(d.Z,{className:"w-4 h-4 text-destructive"})})]},l)),!(null===(g=X.comments)||void 0===g?void 0:g.length)&&(0,a.jsx)("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No hay comentarios a\xfan. \xa1S\xe9 el primero!"})]}),(0,a.jsxs)("div",{className:"mt-6 flex items-center gap-2",children:[(0,a.jsxs)(v.qE,{className:"w-8 h-8 shrink-0",children:[(0,a.jsx)(v.F$,{src:D.profileImage}),(0,a.jsx)(v.Q5,{children:D.name.charAt(0)})]}),(0,a.jsx)(p.I,{placeholder:"A\xf1ade un comentario...",value:K,onChange:e=>L(e.target.value),onKeyDown:e=>"Enter"===e.key&&Y()}),(0,a.jsx)(n.z,{onClick:Y,disabled:!K.trim(),size:"icon",children:(0,a.jsx)(j.Z,{className:"h-4 w-4"})})]})]})]})})]})}):null}},90641:function(e,l,s){s.d(l,{x:function(){return i}});var a=s(57437),r=s(2265),t=s(43643),n=s(93448);let i=r.forwardRef((e,l)=>{let{className:s,children:r,...i}=e;return(0,a.jsxs)(t.fC,{ref:l,className:(0,n.cn)("relative overflow-hidden",s),...i,children:[(0,a.jsx)(t.l_,{className:"h-full w-full rounded-[inherit]",children:r}),(0,a.jsx)(c,{}),(0,a.jsx)(t.Ns,{})]})});i.displayName=t.fC.displayName;let c=r.forwardRef((e,l)=>{let{className:s,orientation:r="vertical",...i}=e;return(0,a.jsx)(t.gb,{ref:l,orientation:r,className:(0,n.cn)("flex touch-none select-none transition-colors","vertical"===r&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===r&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...i,children:(0,a.jsx)(t.q4,{className:"relative flex-1 rounded-full bg-border"})})});c.displayName=t.gb.displayName},31593:function(e,l,s){s.d(l,{Z:function(){return i}});var a=s(57437),r=s(2265),t=s(55156),n=s(93448);let i=r.forwardRef((e,l)=>{let{className:s,orientation:r="horizontal",decorative:i=!0,...c}=e;return(0,a.jsx)(t.f,{ref:l,decorative:i,orientation:r,className:(0,n.cn)("shrink-0 bg-border","horizontal"===r?"h-[1px] w-full":"h-full w-[1px]",s),...c})});i.displayName=t.f.displayName},33507:function(e,l,s){s.d(l,{Ck:function(){return i},Fn:function(){return o},Ms:function(){return t},nd:function(){return c},ry:function(){return n},yT:function(){return r}}),s(83079);var a=s(12119),r=(0,a.$)("1e07348ea432662ad092ac802f4a5c62c0b6584a"),t=(0,a.$)("feab6f8fe3596605c3a56acf95b545caf1fe8f10"),n=(0,a.$)("097b808e0ece62513ed2a928f4e9a74b2f5cd67b"),i=(0,a.$)("6970a6d88c9c6363fee8be49e1b820441b76289d"),c=(0,a.$)("911f01a7adbee5e89e0dc6003ef17b4f0ac1f24c"),o=(0,a.$)("d10c5b0c5dc185c0719b914043fd17b76a901250")}}]);