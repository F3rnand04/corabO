(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4750],{46816:function(e,t,r){Promise.resolve().then(r.bind(r,2030))},49322:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(79205).Z)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},69076:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(79205).Z)("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]])},73247:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(79205).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},15868:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(79205).Z)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]])},24369:function(e,t,r){"use strict";var n=r(2265),s="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},i=n.useState,a=n.useEffect,u=n.useLayoutEffect,o=n.useDebugValue;function l(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!s(e,r)}catch(e){return!0}}var c="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var r=t(),n=i({inst:{value:r,getSnapshot:t}}),s=n[0].inst,c=n[1];return u(function(){s.value=r,s.getSnapshot=t,l(s)&&c({inst:s})},[e,r,t]),a(function(){return l(s)&&c({inst:s}),e(function(){l(s)&&c({inst:s})})},[e]),o(r),r};t.useSyncExternalStore=void 0!==n.useSyncExternalStore?n.useSyncExternalStore:c},82558:function(e,t,r){"use strict";e.exports=r(24369)},2030:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return N}});var n=r(57437),s=r(2265),i=r(70061),a=r(12381),u=r(40279),o=r(92451),l=r(15868),c=r(73247),d=r(99376),f=r(96246),m=r(69174),p=r(93448),v=r(24158),x=r(93292),g=r(79684);function b(e){let{conversation:t,otherParticipant:r}=e,{currentUser:s}=(0,i.a)(),a=(0,d.useRouter)();if(!s)return null;let u=t.messages[t.messages.length-1],o=t.messages.filter(e=>!e.isRead&&e.senderId!==s.id).length,l=u?(0,v.Q)(new Date(u.timestamp),{addSuffix:!0,locale:x.es}):"",c=r?r.id===s.id?"T\xfa (Notas)":r.name:"Sistema",b=r?r.profileImage:"https://i.postimg.cc/SNqD5pqW/avatar-placeholder.png",h=c.charAt(0)||"S",y=r&&r.id!==s.id?"bg-background hover:bg-muted/80":"bg-blue-50 border border-blue-200 hover:bg-blue-100/80",j=r?(r.id,s.id,""):"text-blue-800",N=async()=>{if(!r){a.push("/messages/".concat(t.id));return}let e=[s.id,r.id].sort().join("-");o>0&&(0,g.R7)(e),a.push("/messages/".concat(e))};return(0,n.jsxs)("div",{onClick:N,className:(0,p.cn)("flex items-center p-3 gap-4 rounded-xl shadow-sm cursor-pointer transition-colors",y),children:[(0,n.jsxs)(f.qE,{className:"w-14 h-14",children:[(0,n.jsx)(f.F$,{src:b,alt:c}),(0,n.jsx)(f.Q5,{children:h})]}),(0,n.jsxs)("div",{className:"flex-grow overflow-hidden",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsx)("p",{className:(0,p.cn)("font-semibold truncate",j),children:c}),(0,n.jsx)("p",{className:(0,p.cn)("text-xs shrink-0 pl-2",r?o>0?"text-primary font-bold":"text-muted-foreground":"text-blue-600 font-medium"),children:l})]}),(0,n.jsxs)("div",{className:"flex justify-between items-center mt-1",children:[(0,n.jsx)("p",{className:(0,p.cn)("text-sm truncate pr-2",r?"text-muted-foreground":"text-blue-700/90"),children:(null==u?void 0:u.type)==="proposal"?"\uD83D\uDCDD Propuesta de Acuerdo":(null==u?void 0:u.text)||"No hay mensajes todav\xeda."}),o>0&&(0,n.jsx)(m.C,{variant:"default",className:(0,p.cn)("w-6 h-6 flex items-center justify-center p-0 rounded-full shrink-0",!r&&"bg-blue-500 hover:bg-blue-600"),children:o})]})]})]})}var h=r(67135),y=r(69140);function j(){let e=(0,d.useRouter)();return(0,n.jsx)("header",{className:"sticky top-0 z-30 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 border-b",children:(0,n.jsx)("div",{className:"container px-4 sm:px-6",children:(0,n.jsxs)("div",{className:"flex h-16 items-center justify-between",children:[(0,n.jsx)(a.z,{variant:"ghost",size:"icon",onClick:()=>e.back(),children:(0,n.jsx)(o.Z,{className:"h-6 w-6"})}),(0,n.jsx)("h1",{className:"text-xl font-semibold",children:"Mensajes"}),(0,n.jsx)(a.z,{variant:"ghost",size:"icon",children:(0,n.jsx)(l.Z,{className:"h-6 w-6 text-muted-foreground"})})]})})})}function N(){let{currentUser:e,conversations:t,users:r,isLoadingAuth:a}=(0,i.a)(),[o,l]=(0,s.useState)(""),d=(null==e?void 0:e.type)==="client"&&!(null==e?void 0:e.isTransactionsActive),f=(0,s.useMemo)(()=>[...t].sort((e,t)=>new Date(t.lastUpdated).getTime()-new Date(e.lastUpdated).getTime()),[t]),m=(0,s.useMemo)(()=>e?f.filter(t=>{var n;let s=o.toLowerCase().trim();if(!s)return!0;let i=t.participantIds.find(t=>t!==e.id),a=i?r.find(e=>e.id===i):1===t.participantIds.length?e:null,u=((null===(n=t.messages[t.messages.length-1])||void 0===n?void 0:n.text)||"").toLowerCase().includes(s),l=null==a?void 0:a.name.toLowerCase().includes(s);return u||l}):[],[f,o,e,r]);return(0,n.jsxs)("div",{className:"flex flex-col h-screen bg-muted/20",children:[(0,n.jsx)(j,{}),(0,n.jsxs)("div",{className:"container py-4 px-4 space-y-4",children:[d&&(0,n.jsx)(h.u,{userType:"client"}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)(c.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),(0,n.jsx)(u.I,{placeholder:"Buscar chat o mensaje...",className:"pl-10 rounded-full bg-background",value:o,onChange:e=>l(e.target.value)})]})]}),(0,n.jsx)("main",{className:"flex-1 overflow-y-auto",children:a?(0,n.jsx)("div",{className:"space-y-2 px-4",children:Array.from({length:5}).map((e,t)=>(0,n.jsx)(y.O,{className:"h-20 w-full"},t))}):m.length>0?(0,n.jsx)("div",{className:"space-y-2 px-4 pb-24",children:m.map(t=>{let s=t.participantIds.find(t=>t!==(null==e?void 0:e.id)),i=s?r.find(e=>e.id===s):1===t.participantIds.length?e:null;return i?(0,n.jsx)(b,{conversation:t,otherParticipant:i},t.id):null}).filter(Boolean)}):(0,n.jsx)("div",{className:"text-center py-20",children:(0,n.jsx)("p",{className:"text-muted-foreground",children:"No tienes conversaciones."})})})]})}},67135:function(e,t,r){"use strict";r.d(t,{u:function(){return c}});var n=r(57437),s=r(95937),i=r(12381),a=r(70061),u=r(69076),o=r(49322),l=r(99376);function c(e){let{userType:t}=e,{currentUser:r}=(0,a.a)(),c=(0,l.useRouter)();if(!r)return null;let d=null==r?void 0:r.isPaused,f={client:{title:"\xa1Activa tu registro!",description:"Disfruta de compras seguras y con seguimiento.",buttonText:"Activar ahora"},provider:{title:"\xa1Activa tu registro!",description:"Empieza a recibir pagos y a gestionar tus ingresos de forma segura.",buttonText:"Activar ahora"},repartidor:{title:"\xa1Activa tu registro!",description:"Completa tu perfil para poder aceptar entregas.",buttonText:"Activar ahora"}},{title:m,description:p,buttonText:v}=d?{title:"\xa1Tu cuenta est\xe1 en pausa!",description:"Debido a inactividad, algunas funciones han sido desactivadas. Act\xedvalas de nuevo.",buttonText:"Reactivar Registro"}:f[t]||f.client,x=d?u.Z:o.Z;return(0,n.jsxs)(s.bZ,{children:[(0,n.jsx)(x,{className:"h-4 w-4"}),(0,n.jsx)(s.Cd,{className:"font-semibold",children:m}),(0,n.jsxs)(s.X,{className:"flex justify-between items-center",children:[(0,n.jsx)("span",{children:p}),(0,n.jsxs)(i.z,{variant:"link",size:"sm",onClick:()=>{var e,t;if(r.isPaused){c.push("/transactions/settings");return}if((null===(e=r.profileSetupData)||void 0===e?void 0:e.providerType)==="company"&&!(null===(t=r.profileSetupData)||void 0===t?void 0:t.specialty)){c.push("/profile-setup");return}r.isInitialSetupComplete?"verified"!==r.idVerificationStatus?c.push("/profile-setup/verify-id"):c.push("/transactions/settings"):c.push("/profile-setup")},className:"p-0 h-auto text-current font-bold",children:[v," â†’"]})]})]})}},95937:function(e,t,r){"use strict";r.d(t,{Cd:function(){return l},X:function(){return c},bZ:function(){return o}});var n=r(57437),s=r(2265),i=r(90535),a=r(93448);let u=(0,i.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive",warning:"border-amber-500/50 text-amber-700 dark:border-amber-600 dark:text-amber-500 [&>svg]:text-amber-600 dark:[&>svg]:text-amber-500"}},defaultVariants:{variant:"default"}}),o=s.forwardRef((e,t)=>{let{className:r,variant:s,...i}=e;return(0,n.jsx)("div",{ref:t,role:"alert",className:(0,a.cn)(u({variant:s}),r),...i})});o.displayName="Alert";let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("h5",{ref:t,className:(0,a.cn)("mb-1 font-medium leading-none tracking-tight",r),...s})});l.displayName="AlertTitle";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("text-sm [&_p]:leading-relaxed",r),...s})});c.displayName="AlertDescription"},96246:function(e,t,r){"use strict";r.d(t,{F$:function(){return o},Q5:function(){return l},qE:function(){return u}});var n=r(57437),s=r(2265),i=r(61146),a=r(93448);let u=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)(i.fC,{ref:t,className:(0,a.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",r),...s})});u.displayName=i.fC.displayName;let o=s.forwardRef((e,t)=>{let{className:r,src:s,...u}=e;return(0,n.jsx)(i.Ee,{ref:t,src:s||void 0,className:(0,a.cn)("aspect-square h-full w-full",r),...u})});o.displayName=i.Ee.displayName;let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)(i.NY,{ref:t,className:(0,a.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",r),...s})});l.displayName=i.NY.displayName},69174:function(e,t,r){"use strict";r.d(t,{C:function(){return u}});var n=r(57437);r(2265);var s=r(90535),i=r(93448);let a=(0,s.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function u(e){let{className:t,variant:r,...s}=e;return(0,n.jsx)("div",{className:(0,i.cn)(a({variant:r}),t),...s})}},40279:function(e,t,r){"use strict";r.d(t,{I:function(){return a}});var n=r(57437),s=r(2265),i=r(93448);let a=s.forwardRef((e,t)=>{let{className:r,type:s,...a}=e;return(0,n.jsx)("input",{type:s,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...a})});a.displayName="Input"},69140:function(e,t,r){"use strict";r.d(t,{O:function(){return i}});var n=r(57437),s=r(93448);function i(e){let{className:t,...r}=e;return(0,n.jsx)("div",{className:(0,s.cn)("animate-pulse rounded-md bg-muted",t),...r})}},79684:function(e,t,r){"use strict";r.d(t,{R7:function(){return i},bG:function(){return s}}),r(83079);var n=r(12119);(0,n.$)("66a7e77381968e9347e32d9d375d0a488bb06bbb");var s=(0,n.$)("164e4611f07bc012094243de7aad1b85f88a7558"),i=(0,n.$)("080ba4c4ad92ec9d4477bc2807fa26292714577e")},61146:function(e,t,r){"use strict";r.d(t,{NY:function(){return k},Ee:function(){return w},fC:function(){return N}});var n=r(2265),s=r(73966),i=r(26606),a=r(61188),u=r(66840),o=r(82558);function l(){return()=>{}}var c=r(57437),d="Avatar",[f,m]=(0,s.b)(d),[p,v]=f(d),x=n.forwardRef((e,t)=>{let{__scopeAvatar:r,...s}=e,[i,a]=n.useState("idle");return(0,c.jsx)(p,{scope:r,imageLoadingStatus:i,onImageLoadingStatusChange:a,children:(0,c.jsx)(u.WV.span,{...s,ref:t})})});x.displayName=d;var g="AvatarImage",b=n.forwardRef((e,t)=>{let{__scopeAvatar:r,src:s,onLoadingStatusChange:d=()=>{},...f}=e,m=v(g,r),p=function(e,t){let{referrerPolicy:r,crossOrigin:s}=t,i=(0,o.useSyncExternalStore)(l,()=>!0,()=>!1),u=n.useRef(null),c=i?(u.current||(u.current=new window.Image),u.current):null,[d,f]=n.useState(()=>j(c,e));return(0,a.b)(()=>{f(j(c,e))},[c,e]),(0,a.b)(()=>{let e=e=>()=>{f(e)};if(!c)return;let t=e("loaded"),n=e("error");return c.addEventListener("load",t),c.addEventListener("error",n),r&&(c.referrerPolicy=r),"string"==typeof s&&(c.crossOrigin=s),()=>{c.removeEventListener("load",t),c.removeEventListener("error",n)}},[c,s,r]),d}(s,f),x=(0,i.W)(e=>{d(e),m.onImageLoadingStatusChange(e)});return(0,a.b)(()=>{"idle"!==p&&x(p)},[p,x]),"loaded"===p?(0,c.jsx)(u.WV.img,{...f,ref:t,src:s}):null});b.displayName=g;var h="AvatarFallback",y=n.forwardRef((e,t)=>{let{__scopeAvatar:r,delayMs:s,...i}=e,a=v(h,r),[o,l]=n.useState(void 0===s);return n.useEffect(()=>{if(void 0!==s){let e=window.setTimeout(()=>l(!0),s);return()=>window.clearTimeout(e)}},[s]),o&&"loaded"!==a.imageLoadingStatus?(0,c.jsx)(u.WV.span,{...i,ref:t}):null});function j(e,t){return e?t?(e.src!==t&&(e.src=t),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}y.displayName=h;var N=x,w=b,k=y},73966:function(e,t,r){"use strict";r.d(t,{b:function(){return a},k:function(){return i}});var n=r(2265),s=r(57437);function i(e,t){let r=n.createContext(t),i=e=>{let{children:t,...i}=e,a=n.useMemo(()=>i,Object.values(i));return(0,s.jsx)(r.Provider,{value:a,children:t})};return i.displayName=e+"Provider",[i,function(s){let i=n.useContext(r);if(i)return i;if(void 0!==t)return t;throw Error(`\`${s}\` must be used within \`${e}\``)}]}function a(e,t=[]){let r=[],i=()=>{let t=r.map(e=>n.createContext(e));return function(r){let s=r?.[e]||t;return n.useMemo(()=>({[`__scope${e}`]:{...r,[e]:s}}),[r,s])}};return i.scopeName=e,[function(t,i){let a=n.createContext(i),u=r.length;r=[...r,i];let o=t=>{let{scope:r,children:i,...o}=t,l=r?.[e]?.[u]||a,c=n.useMemo(()=>o,Object.values(o));return(0,s.jsx)(l.Provider,{value:c,children:i})};return o.displayName=t+"Provider",[o,function(r,s){let o=s?.[e]?.[u]||a,l=n.useContext(o);if(l)return l;if(void 0!==i)return i;throw Error(`\`${r}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let r=()=>{let r=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let s=r.reduce((t,{useScope:r,scopeName:n})=>{let s=r(e)[`__scope${n}`];return{...t,...s}},{});return n.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return r.scopeName=t.scopeName,r}(i,...t)]}},66840:function(e,t,r){"use strict";r.d(t,{WV:function(){return u},jH:function(){return o}});var n=r(2265),s=r(54887),i=r(37053),a=r(57437),u=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=(0,i.Z8)(`Primitive.${t}`),s=n.forwardRef((e,n)=>{let{asChild:s,...i}=e,u=s?r:t;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,a.jsx)(u,{...i,ref:n})});return s.displayName=`Primitive.${t}`,{...e,[t]:s}},{});function o(e,t){e&&s.flushSync(()=>e.dispatchEvent(t))}},26606:function(e,t,r){"use strict";r.d(t,{W:function(){return s}});var n=r(2265);function s(e){let t=n.useRef(e);return n.useEffect(()=>{t.current=e}),n.useMemo(()=>(...e)=>t.current?.(...e),[])}},61188:function(e,t,r){"use strict";r.d(t,{b:function(){return s}});var n=r(2265),s=globalThis?.document?n.useLayoutEffect:()=>{}}},function(e){e.O(0,[3609,9015,2522,2939,2859,3593,803,2971,2117,1744],function(){return e(e.s=46816)}),_N_E=e.O()}]);