(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5806],{2427:function(e,t,a){Promise.resolve().then(a.bind(a,11533))},4948:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(79205).Z)("Handshake",[["path",{d:"m11 17 2 2a1 1 0 1 0 3-3",key:"efffak"}],["path",{d:"m14 14 2.5 2.5a1 1 0 1 0 3-3l-3.88-3.88a3 3 0 0 0-4.24 0l-.88.88a1 1 0 1 1-3-3l2.81-2.81a5.79 5.79 0 0 1 7.06-.87l.47.28a2 2 0 0 0 1.42.25L21 4",key:"9pr0kb"}],["path",{d:"m21 3 1 11h-2",key:"1tisrp"}],["path",{d:"M3 3 2 14l6.5 6.5a1 1 0 1 0 3-3",key:"1uvwmv"}],["path",{d:"M3 4h8",key:"1ep09j"}]])},44743:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(79205).Z)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]])},11533:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return Y}});var r=a(57437),n=a(2265),s=a(99376),i=a(70061),l=a(12381),o=a(40279),d=a(96246),c=a(92451),u=a(83774),f=a(31047),m=a(79205);let p=(0,m.Z)("Forward",[["polyline",{points:"15 17 20 12 15 7",key:"1w3sku"}],["path",{d:"M4 18v-2a4 4 0 0 1 4-4h12",key:"jmiej9"}]]);var x=a(4948),h=a(86595);let v=(0,m.Z)("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);var b=a(51817),g=a(76865);let j=(0,m.Z)("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]),y=(0,m.Z)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);var N=a(44743),w=a(93448),k=a(90641),C=a(29750),S=a(93292),I=a(12749),z=a(46291),D=a(84604),E=a(31593),R=a(29501),_=a(13590),M=a(67119),Z=a(74291),A=a(80670),F=a(23675),$=a(94589),P=a(79684),H=a(23340);let G=M.Ry({title:M.Z_().min(5,"El t\xedtulo debe tener al menos 5 caracteres."),description:M.Z_().min(10,"La descripci\xf3n debe tener al menos 10 caracteres."),amount:M.oQ.number().min(0,"El monto no puede ser negativo."),deliveryDate:M.hT({required_error:"Debes seleccionar una fecha."}),acceptsCredicora:M.O7().default(!1)}),O={"Salud y Bienestar":{title:"Ej: Consulta de Fisioterapia inicial",description:"Incluye evaluaci\xf3n postural, plan de tratamiento y primera sesi\xf3n de terapia manual."},"Hogar y Reparaciones":{title:"Ej: Instalaci\xf3n de l\xe1mpara de techo",description:"Incluye desinstalaci\xf3n de l\xe1mpara anterior, montaje seguro y conexi\xf3n el\xe9ctrica. No incluye la l\xe1mpara."},"Tecnolog\xeda y Soporte":{title:"Ej: Mantenimiento preventivo de laptop",description:"Limpieza interna de hardware, optimizaci\xf3n de software y revisi\xf3n de estado del sistema."},Belleza:{title:"Ej: Servicio de Manicure y Pedicure Completo",description:"Incluye limado, tratamiento de cut\xedculas, exfoliaci\xf3n y esmaltado semi-permanente."},default:{title:"Ej: Reparaci\xf3n de fuga en ba\xf1o principal",description:"Incluye materiales, tiempo estimado, etc."}};function W(e){var t,a;let{isOpen:s,onOpenChange:d,conversationId:c}=e,{currentUser:u}=(0,i.a)(),{toast:m}=(0,H.pm)(),[p,v]=(0,n.useState)(!1),g=(0,R.cI)({resolver:(0,_.F)(G),defaultValues:{title:"",description:"",amount:0,acceptsCredicora:(null==u?void 0:null===(t=u.profileSetupData)||void 0===t?void 0:t.acceptsCredicora)||!1}}),j=async e=>{if(u){v(!0);try{let t=c.replace(u.id,"").replace("-","");await (0,P.bG)({senderId:u.id,recipientId:t,conversationId:c,proposal:{...e,deliveryDate:e.deliveryDate.toISOString()}}),m({title:"Propuesta Enviada",description:"El cliente ha sido notificado."}),g.reset(),d(!1)}catch(e){m({variant:"destructive",title:"Error",description:e instanceof Error?e.message:"No se pudo enviar la propuesta."})}finally{v(!1)}}},y=O[(null==u?void 0:null===(a=u.profileSetupData)||void 0===a?void 0:a.primaryCategory)||"default"]||O.default;return(0,r.jsx)(Z.Vq,{open:s,onOpenChange:d,children:(0,r.jsxs)(Z.cZ,{className:"sm:max-w-md",children:[(0,r.jsxs)(Z.fK,{children:[(0,r.jsxs)(Z.$N,{className:"flex items-center gap-2",children:[(0,r.jsx)(x.Z,{})," Crear Propuesta de Acuerdo"]}),(0,r.jsx)(Z.Be,{children:"Define los t\xe9rminos del servicio. El cliente deber\xe1 aceptarlos para continuar."})]}),(0,r.jsx)(A.l0,{...g,children:(0,r.jsxs)("form",{onSubmit:g.handleSubmit(j),className:"space-y-4 py-4",children:[(0,r.jsx)(A.Wi,{control:g.control,name:"title",render:e=>{let{field:t}=e;return(0,r.jsxs)(A.xJ,{children:[(0,r.jsx)(A.lX,{children:"T\xedtulo"}),(0,r.jsx)(A.NI,{children:(0,r.jsx)(o.I,{placeholder:y.title,...t})}),(0,r.jsx)(A.zG,{})]})}}),(0,r.jsx)(A.Wi,{control:g.control,name:"description",render:e=>{let{field:t}=e;return(0,r.jsxs)(A.xJ,{children:[(0,r.jsx)(A.lX,{children:"Descripci\xf3n Detallada"}),(0,r.jsx)(A.NI,{children:(0,r.jsx)(F.g,{placeholder:y.description,...t})}),(0,r.jsx)(A.zG,{})]})}}),(0,r.jsx)(A.Wi,{control:g.control,name:"amount",render:e=>{let{field:t}=e;return(0,r.jsxs)(A.xJ,{children:[(0,r.jsx)(A.lX,{children:"Monto Total (USD)"}),(0,r.jsx)(A.NI,{children:(0,r.jsx)(o.I,{type:"number",...t})}),(0,r.jsx)(A.zG,{})]})}}),(0,r.jsx)(A.Wi,{control:g.control,name:"deliveryDate",render:e=>{let{field:t}=e;return(0,r.jsxs)(A.xJ,{className:"flex flex-col",children:[(0,r.jsx)(A.lX,{children:"Fecha de Entrega/Cita"}),(0,r.jsxs)(I.J2,{children:[(0,r.jsx)(I.xo,{asChild:!0,children:(0,r.jsx)(A.NI,{children:(0,r.jsxs)(l.z,{variant:"outline",className:(0,w.cn)("pl-3 text-left font-normal",!t.value&&"text-muted-foreground"),children:[t.value?(0,C.WU)(t.value,"PPP"):(0,r.jsx)("span",{children:"Elige una fecha"}),(0,r.jsx)(f.Z,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),(0,r.jsx)(I.yk,{className:"w-auto p-0",align:"start",children:(0,r.jsx)(z.f,{mode:"single",selected:t.value,onSelect:t.onChange,disabled:e=>e<new Date,initialFocus:!0})})]}),(0,r.jsx)(A.zG,{})]})}}),(0,r.jsx)(A.Wi,{control:g.control,name:"acceptsCredicora",render:e=>{let{field:t}=e;return(0,r.jsxs)(A.xJ,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[(0,r.jsx)("div",{className:"space-y-0.5",children:(0,r.jsxs)(A.lX,{className:"flex items-center gap-2 text-blue-600",children:[(0,r.jsx)(h.Z,{className:"w-4 h-4 fill-current"}),"Aceptar Credicora"]})}),(0,r.jsx)(A.NI,{children:(0,r.jsx)($.r,{checked:t.value,onCheckedChange:t.onChange})})]})}}),(0,r.jsxs)(Z.cN,{children:[(0,r.jsx)(l.z,{type:"button",variant:"outline",onClick:()=>d(!1),children:"Cancelar"}),(0,r.jsxs)(l.z,{type:"submit",disabled:p,children:[p&&(0,r.jsx)(b.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Enviar Propuesta"]})]})]})})]})})}var V=a(27648),q=a(95937),J=a(33145),U=a(22299);function L(e){var t,a,i,o;let{participant:m,isSelfChat:p,onDateSelect:x}=e,h=(0,s.useRouter)(),[v,b]=(0,n.useState)("closed"),g=Object.entries((null===(t=m.profileSetupData)||void 0===t?void 0:t.schedule)||{}).filter(e=>{let[,t]=e;return!t.active}).map(e=>{let[t]=e;return({Domingo:0,Lunes:1,Martes:2,Miércoles:3,Jueves:4,Viernes:5,Sábado:6})[t]});return(0,r.jsxs)("header",{className:"sticky top-0 z-30 flex items-center justify-between p-2 border-b bg-background/95 backdrop-blur",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(l.z,{variant:"ghost",size:"icon",onClick:()=>h.push("/messages"),children:(0,r.jsx)(c.Z,{className:"h-6 w-6"})}),(0,r.jsxs)(V.default,{href:"/companies/".concat(m.id),className:"flex items-center gap-2 cursor-pointer group",children:[(0,r.jsxs)(d.qE,{className:"w-10 h-10",children:[(0,r.jsx)(d.F$,{src:m.profileImage,alt:m.name}),(0,r.jsx)(d.Q5,{children:m.name.charAt(0)})]}),(0,r.jsx)("h2",{className:"font-semibold group-hover:underline",children:p?"T\xfa (Notas)":m.name})]})]}),!p&&(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(l.z,{variant:"ghost",size:"icon",disabled:!(null===(a=m.profileSetupData)||void 0===a?void 0:a.hasPhysicalLocation),onClick:()=>h.push("/map"),children:(0,r.jsx)(u.Z,{className:(0,w.cn)("h-5 w-5",m.isGpsActive&&(null===(i=m.profileSetupData)||void 0===i?void 0:i.hasPhysicalLocation)?"text-green-500":"text-muted-foreground")})}),(0,r.jsxs)(I.J2,{children:[(0,r.jsx)(I.xo,{asChild:!0,children:(0,r.jsx)(l.z,{variant:"ghost",size:"icon",children:(0,r.jsx)(f.Z,{className:(0,w.cn)("h-5 w-5",{"text-green-500":"open"===v,"text-red-500":"closed"===v})})})}),(0,r.jsxs)(I.yk,{className:"w-auto p-0",children:[(0,r.jsx)("div",{className:"p-3 flex items-center justify-between",children:(0,r.jsx)(D.O,{schedule:null===(o=m.profileSetupData)||void 0===o?void 0:o.schedule,onStatusChange:b})}),(0,r.jsx)(E.Z,{}),(0,r.jsx)(z.f,{mode:"single",onSelect:e=>{e&&x(e)},disabled:[{dayOfWeek:g},{before:new Date}],initialFocus:!0}),(0,r.jsx)("div",{className:"p-2 border-t text-center text-xs text-muted-foreground",children:"D\xedas no laborales desactivados."})]})]})]})]})}function T(e){let{lat:t,lon:a,onForward:n}=e,s="https://www.google.com/maps?q=".concat(t,",").concat(a);return(0,r.jsxs)("div",{className:"flex flex-col items-center w-full my-2",children:[(0,r.jsxs)("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"block w-full max-w-sm rounded-lg border bg-background shadow-md p-0.5 space-y-1 overflow-hidden group",children:[(0,r.jsx)("div",{className:"relative aspect-video w-full",children:(0,r.jsx)(J.default,{src:"https://placehold.co/400x200.png?text=Mapa",alt:"Mapa de ubicaci\xf3n",fill:!0,style:{objectFit:"cover"},"data-ai-hint":"map location",className:"group-hover:scale-105 transition-transform duration-300"})}),(0,r.jsxs)("div",{className:"p-2 text-center",children:[(0,r.jsx)("p",{className:"text-sm font-semibold",children:"Ubicaci\xf3n Compartida"}),(0,r.jsx)("p",{className:"text-xs text-blue-600 group-hover:underline",children:"Ver en Google Maps"})]})]}),(0,r.jsxs)(l.z,{variant:"outline",size:"sm",className:"mt-2",onClick:n,children:[(0,r.jsx)(p,{className:"w-4 h-4 mr-2"}),"Reenviar Ubicaci\xf3n"]})]})}function Q(e){var t,a;let{msg:s,onAccept:o,canAccept:d}=e,{currentUser:c}=(0,i.a)(),[u,f]=(0,n.useState)(null);if((0,n.useEffect)(()=>{var e;(null===(e=s.proposal)||void 0===e?void 0:e.deliveryDate)&&f((0,C.WU)(new Date(s.proposal.deliveryDate),"dd/MM/yyyy 'a las' HH:mm"))},[null===(t=s.proposal)||void 0===t?void 0:t.deliveryDate]),!c)return null;let m=(null==c?void 0:c.type)==="client",p=s.isProposalAccepted,v=s.proposal;if(!v)return null;let b="hourly"===v.pricingModel,g=b?(v.hourlyRate||0)*(v.estimatedHours||0):v.amount;return(0,r.jsx)("div",{className:"flex justify-center w-full my-2",children:(0,r.jsxs)("div",{className:"w-full max-w-sm rounded-lg border bg-background shadow-lg p-4 space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(x.Z,{className:"w-6 h-6 text-primary"}),(0,r.jsx)("h3",{className:"font-bold text-lg",children:v.title})]}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground line-clamp-3",children:v.description}),(0,r.jsx)(E.Z,{}),b?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-muted-foreground",children:"Tarifa:"}),(0,r.jsxs)("span",{className:"font-semibold",children:["$",null===(a=v.hourlyRate)||void 0===a?void 0:a.toFixed(2)," / hora"]})]}),(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-muted-foreground",children:"Horas Estimadas:"}),(0,r.jsxs)("span",{className:"font-semibold",children:[v.estimatedHours,"h"]})]})]}):null,(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-muted-foreground",children:"Fecha Entrega:"}),(0,r.jsx)("span",{className:"font-semibold",children:u||"..."})]}),(0,r.jsxs)("div",{className:"flex justify-between items-baseline text-sm",children:[(0,r.jsx)("span",{className:"text-muted-foreground",children:"Total Estimado:"}),(0,r.jsxs)("span",{className:"font-bold text-xl",children:["$",g.toFixed(2)]})]}),v.acceptsCredicora&&(0,r.jsxs)("div",{className:"flex items-center gap-2 text-blue-600",children:[(0,r.jsx)(h.Z,{className:"w-4 h-4 fill-current"}),(0,r.jsx)("span",{className:"text-sm font-semibold",children:"Acepta Credicora"})]}),(0,r.jsxs)("div",{className:"pt-2",children:[m&&!p&&(0,r.jsx)(l.z,{className:"w-full",onClick:()=>o(s.id),disabled:!d,children:"Revisar y Aceptar"}),p&&(0,r.jsx)("div",{className:"text-center font-semibold text-green-600 p-2 bg-green-50 border border-green-200 rounded-md",children:"Acuerdo Aceptado"}),!m&&!p&&(0,r.jsx)("div",{className:"text-center font-semibold text-yellow-600 p-2 bg-yellow-50 border border-yellow-200 rounded-md",children:"Propuesta Enviada - Esperando Cliente"})]})]})})}function X(e){let{msg:t,isCurrentUser:a,onAccept:s,canAcceptProposal:i,onForwardLocation:l}=e,[o,d]=(0,n.useState)("");return((0,n.useEffect)(()=>{d((0,C.WU)(new Date(t.timestamp),"HH:mm"))},[t.timestamp]),"proposal"===t.type)?(0,r.jsx)(Q,{msg:t,onAccept:s,canAccept:i}):"location"===t.type&&t.location?(0,r.jsx)(T,{lat:t.location.lat,lon:t.location.lon,onForward:()=>l(t.location)}):(0,r.jsx)("div",{className:(0,w.cn)("flex items-end gap-2 max-w-[85%] w-fit",a?"ml-auto":"mr-auto"),children:(0,r.jsxs)("div",{className:(0,w.cn)("p-2 rounded-lg shadow-md",a?"bg-primary text-primary-foreground rounded-br-none":"bg-background rounded-bl-none"),children:[(0,r.jsx)("p",{className:"text-sm pr-8",children:t.text}),(0,r.jsxs)("div",{className:"flex items-center justify-end gap-1 mt-1 h-4",children:[(0,r.jsx)("p",{className:(0,w.cn)("text-xs",a?"text-primary-foreground/70":"text-muted-foreground/70"),children:o||"..."}),a&&(0,r.jsx)(v,{className:(0,w.cn)("w-4 h-4",t.isRead?"text-blue-400":"text-primary-foreground/50")})]})]})})}function Y(){var e;let t=(0,s.useParams)();(0,s.useRouter)();let{currentUser:a,conversations:d,users:c,setDeliveryAddressToCurrent:f,currentUserLocation:m}=(0,i.a)(),{toast:p}=(0,H.pm)(),[x,h]=(0,n.useState)(null),[v,w]=(0,n.useState)(""),[z,D]=(0,n.useState)(!0),[E,R]=(0,n.useState)(!1),[_,M]=(0,n.useState)(!1),Z=(0,n.useRef)(null),A=null==t?void 0:t.id,F=d.find(e=>e.id===A);if((0,n.useEffect)(()=>{var e,t;if(!a||!F){D(0===d.length);return}let r=null===(e=F.participantIds)||void 0===e?void 0:e.find(e=>e!==a.id);(null===(t=F.participantIds)||void 0===t?void 0:t.every(e=>e===a.id))?(R(!0),h(a)):r?(R(!1),r!==(null==x?void 0:x.id)&&h(c.find(e=>e.id===r)||null)):console.error("Conversation is missing a valid other participant."),(0,P.R7)(A),D(!1)},[A,a,F,null==x?void 0:x.id,c,d]),(0,n.useEffect)(()=>{if(Z.current){let e=Z.current.children[1];e&&(e.scrollTop=e.scrollHeight)}},[null==F?void 0:F.messages]),z||!a||!x||!F)return(0,r.jsx)("div",{className:"flex flex-col h-screen items-center justify-center",children:(0,r.jsx)(b.Z,{className:"w-8 h-8 animate-spin"})});let $=e=>{if(a&&x){if("current"===e)m?(0,P.bG)({recipientId:x.id,location:{lat:m.latitude,lon:m.longitude},conversationId:A,senderId:a.id}):p({variant:"destructive",title:"Ubicaci\xf3n no disponible",description:"Activa los permisos de GPS para compartir tu ubicaci\xf3n actual."});else{var t;if(null===(t=a.profileSetupData)||void 0===t?void 0:t.location){let[e,t]=a.profileSetupData.location.split(",").map(Number);(0,P.bG)({recipientId:x.id,location:{lat:e,lon:t},conversationId:A,senderId:a.id})}else p({variant:"destructive",title:"Sin direcci\xf3n guardada",description:"No tienes una direcci\xf3n guardada en tu perfil."})}}},G=async e=>{if(a){p({title:"Aceptando Propuesta..."});try{await (0,U.g4)({transactionId:A,userId:a.id}),p({title:"Propuesta Aceptada",description:"La transacci\xf3n se ha movido al siguiente estado."})}catch(e){p({title:"Error",description:"No se pudo aceptar la propuesta. Int\xe9ntalo de nuevo.",variant:"destructive"}),console.error("Failed to accept quote:",e)}}},O=(null==a?void 0:a.type)==="provider",V=null!==(e=null==a?void 0:a.isTransactionsActive)&&void 0!==e&&e,J=O&&!E&&!(null==x?void 0:x.isTransactionsActive);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex flex-col h-screen bg-muted/30",children:[(0,r.jsx)(L,{participant:x,isSelfChat:E,onDateSelect:e=>{var t;if(!a||!x)return;let r=(0,C.WU)(e,"EEEE, dd 'de' MMMM 'de' yyyy",{locale:S.es});(0,U.$1)({providerId:x.id,clientId:a.id,date:e.toISOString(),details:"Solicitud de cita para el ".concat(r,"."),amount:(null===(t=x.profileSetupData)||void 0===t?void 0:t.appointmentCost)||0}),(0,P.bG)({recipientId:x.id,text:"\xa1Hola! Me gustar\xeda solicitar una cita para el ".concat(r,". \xbfEst\xe1s disponible?"),conversationId:A,senderId:a.id}),p({title:"Solicitud de Cita Enviada",description:"El proveedor ha sido notificado. Podr\xe1s ver el estado en tu registro de transacciones."})}}),J&&(0,r.jsxs)(q.bZ,{variant:"destructive",className:"rounded-none border-x-0",children:[(0,r.jsx)(g.Z,{className:"h-4 w-4"}),(0,r.jsx)(q.Cd,{children:"Recomendaci\xf3n de Seguridad"}),(0,r.jsx)(q.X,{children:"Este usuario a\xfan no ha activado su registro de transacciones. Sugi\xe9rele activarlo para disfrutar de la seguridad y garant\xedas de la plataforma."})]}),(0,r.jsx)("div",{className:"flex-grow bg-[url('/doodle-bg.png')] bg-repeat",children:(0,r.jsx)(k.x,{className:"h-full",ref:Z,children:(0,r.jsx)("div",{className:"p-4 space-y-2",children:F.messages.map(e=>{let t=e.senderId===a.id;return(0,r.jsx)(X,{msg:e,isCurrentUser:t,onAccept:G,canAcceptProposal:V,onForwardLocation:e=>(0,P.bG)({recipientId:x.id,location:e,conversationId:A,senderId:a.id})},e.id)})})})}),(0,r.jsx)("footer",{className:"p-2 border-t bg-transparent",children:(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),v.trim()&&a&&x&&((0,P.bG)({recipientId:x.id,text:v,conversationId:A,senderId:a.id}),w(""))},className:"flex items-center gap-2",children:[(0,r.jsxs)(I.J2,{children:[(0,r.jsx)(I.xo,{asChild:!0,children:(0,r.jsx)(l.z,{type:"button",variant:"ghost",size:"icon",className:"bg-background rounded-full shadow-md",disabled:E,children:(0,r.jsx)(j,{className:"h-5 w-5 text-muted-foreground"})})}),(0,r.jsx)(I.yk,{side:"top",align:"start",className:"w-auto p-1",children:(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsxs)(I.J2,{children:[(0,r.jsx)(I.xo,{asChild:!0,children:(0,r.jsxs)(l.z,{variant:"ghost",className:"w-full justify-start",children:[(0,r.jsx)(u.Z,{className:"mr-2 h-4 w-4 text-red-500"}),"Ubicaci\xf3n"]})}),(0,r.jsx)(I.yk,{side:"top",align:"start",className:"w-auto p-1 ml-2",children:(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)(l.z,{variant:"ghost",className:"w-full justify-start",onClick:()=>$("current"),children:"Actual (GPS)"}),(0,r.jsx)(l.z,{variant:"ghost",className:"w-full justify-start",onClick:()=>$("saved"),children:"Guardada en Perfil"})]})})]}),O&&!E&&(0,r.jsxs)(l.z,{variant:"ghost",className:"w-full justify-start",onClick:()=>M(!0),children:[(0,r.jsx)(y,{className:"mr-2 h-4 w-4 text-green-500"}),"Propuesta de Acuerdo"]})]})})]}),(0,r.jsx)(o.I,{placeholder:"Escribe un mensaje...",className:"flex-grow rounded-full shadow-md",value:v,onChange:e=>w(e.target.value)}),(0,r.jsx)(l.z,{type:"submit",size:"icon",className:"rounded-full shadow-md",children:(0,r.jsx)(N.Z,{className:"h-5 w-5"})})]})})]}),(0,r.jsx)(W,{isOpen:_,onOpenChange:M,conversationId:A})]})}},84604:function(e,t,a){"use strict";a.d(t,{O:function(){return x}});var r=a(57437),n=a(2265),s=a(13993),i=a(61029),l=a(95775),o=a(39960),d=a(59121),c=a(29750),u=a(93292),f=a(93448);let m={0:"Domingo",1:"Lunes",2:"Martes",3:"Mi\xe9rcoles",4:"Jueves",5:"Viernes",6:"S\xe1bado"},p=e=>"".concat(Math.floor(e/36e5),"h ").concat(Math.floor(e%36e5/6e4),"m");function x(e){let{schedule:t,onStatusChange:a}=e,[x,h]=(0,n.useState)("closed"),[v,b]=(0,n.useState)("");return(0,n.useEffect)(()=>{let e=()=>{if(!t){h("closed"),b("Horario no disponible"),null==a||a("closed");return}let e=new Date,r=t[m[(0,s.w)(e)]];if(r&&r.active){if("00:00"===r.from&&("24:00"===r.to||"23:59"===r.to)){h("open"),b("Abierto 24 horas"),null==a||a("open");return}let t=(0,i.Qc)(r.from,"HH:mm",new Date),n=(0,i.Qc)(r.to,"HH:mm",new Date);if((0,l._)(e,{start:t,end:n})){h("open");let t=p((0,o._)(n,e));b("Cierra en ".concat(t)),null==a||a("open");return}}for(let r=0;r<7;r++){let n=(0,d.E)(e,r),l=t[m[(0,s.w)(n)]];if(l&&l.active){let t=(0,i.Qc)(l.from,"HH:mm",new Date);if(0===r&&e>t)continue;let s=(0,i.Qc)(l.from,"HH:mm",n);h("closed");let o=1===r?"ma\xf1ana":(0,c.WU)(s,"eeee",{locale:u.es}),d=(0,c.WU)(s,"p",{locale:u.es});b("Abre ".concat(o," a la(s) ").concat(d)),null==a||a("closed");return}}h("closed"),b("Cerrado temporalmente"),null==a||a("closed")};e();let r=setInterval(e,6e4);return()=>clearInterval(r)},[t,a]),(0,r.jsxs)("div",{className:"flex items-center gap-2 text-xs font-semibold",children:[(0,r.jsx)("span",{className:(0,f.cn)("w-2 h-2 rounded-full","open"===x?"bg-green-500":"bg-red-500")}),(0,r.jsx)("span",{className:(0,f.cn)("open"===x?"text-green-600":"text-red-600"),children:"open"===x?"Abierto":"Cerrado"}),(0,r.jsxs)("span",{className:"text-muted-foreground font-normal",children:["\xb7 ",v]})]})}},95937:function(e,t,a){"use strict";a.d(t,{Cd:function(){return d},X:function(){return c},bZ:function(){return o}});var r=a(57437),n=a(2265),s=a(90535),i=a(93448);let l=(0,s.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive",warning:"border-amber-500/50 text-amber-700 dark:border-amber-600 dark:text-amber-500 [&>svg]:text-amber-600 dark:[&>svg]:text-amber-500"}},defaultVariants:{variant:"default"}}),o=n.forwardRef((e,t)=>{let{className:a,variant:n,...s}=e;return(0,r.jsx)("div",{ref:t,role:"alert",className:(0,i.cn)(l({variant:n}),a),...s})});o.displayName="Alert";let d=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("h5",{ref:t,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",a),...n})});d.displayName="AlertTitle";let c=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",a),...n})});c.displayName="AlertDescription"},96246:function(e,t,a){"use strict";a.d(t,{F$:function(){return o},Q5:function(){return d},qE:function(){return l}});var r=a(57437),n=a(2265),s=a(61146),i=a(93448);let l=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(s.fC,{ref:t,className:(0,i.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...n})});l.displayName=s.fC.displayName;let o=n.forwardRef((e,t)=>{let{className:a,src:n,...l}=e;return(0,r.jsx)(s.Ee,{ref:t,src:n||void 0,className:(0,i.cn)("aspect-square h-full w-full",a),...l})});o.displayName=s.Ee.displayName;let d=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(s.NY,{ref:t,className:(0,i.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...n})});d.displayName=s.NY.displayName},46291:function(e,t,a){"use strict";a.d(t,{f:function(){return l}});var r=a(57437);a(2265);var n=a(29631),s=a(93448),i=a(12381);function l(e){let{className:t,classNames:a,showOutsideDays:l=!0,...o}=e;return(0,r.jsx)(n._,{showOutsideDays:l,className:(0,s.cn)("p-3",t),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,s.cn)((0,i.d)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,s.cn)((0,i.d)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...a},...o})}l.displayName="Calendar"},74291:function(e,t,a){"use strict";a.d(t,{$N:function(){return h},Be:function(){return v},GG:function(){return u},Vq:function(){return o},cN:function(){return x},cZ:function(){return m},fK:function(){return p},hg:function(){return d}});var r=a(57437),n=a(2265),s=a(49027),i=a(32489),l=a(93448);let o=s.fC,d=s.xz,c=s.h_,u=s.x8,f=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(s.aV,{ref:t,className:(0,l.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...n})});f.displayName=s.aV.displayName;let m=n.forwardRef((e,t)=>{let{className:a,children:n,...o}=e;return(0,r.jsxs)(c,{children:[(0,r.jsx)(f,{}),(0,r.jsxs)(s.VY,{ref:t,className:(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...o,children:[n,(0,r.jsxs)(s.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,r.jsx)(i.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=s.VY.displayName;let p=e=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,l.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};p.displayName="DialogHeader";let x=e=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,l.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};x.displayName="DialogFooter";let h=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(s.Dx,{ref:t,className:(0,l.cn)("text-lg font-semibold leading-none tracking-tight",a),...n})});h.displayName=s.Dx.displayName;let v=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(s.dk,{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",a),...n})});v.displayName=s.dk.displayName},80670:function(e,t,a){"use strict";a.d(t,{NI:function(){return h},Wi:function(){return u},l0:function(){return d},lX:function(){return x},xJ:function(){return p},zG:function(){return v}});var r=a(57437),n=a(2265),s=a(37053),i=a(29501),l=a(93448),o=a(75060);let d=i.RV,c=n.createContext({}),u=e=>{let{...t}=e;return(0,r.jsx)(c.Provider,{value:{name:t.name},children:(0,r.jsx)(i.Qr,{...t})})},f=()=>{let e=n.useContext(c),t=n.useContext(m),{getFieldState:a,formState:r}=(0,i.Gc)(),s=a(e.name,r);if(!e)throw Error("useFormField should be used within <FormField>");let{id:l}=t;return{id:l,name:e.name,formItemId:"".concat(l,"-form-item"),formDescriptionId:"".concat(l,"-form-item-description"),formMessageId:"".concat(l,"-form-item-message"),...s}},m=n.createContext({}),p=n.forwardRef((e,t)=>{let{className:a,...s}=e,i=n.useId();return(0,r.jsx)(m.Provider,{value:{id:i},children:(0,r.jsx)("div",{ref:t,className:(0,l.cn)("space-y-2",a),...s})})});p.displayName="FormItem";let x=n.forwardRef((e,t)=>{let{className:a,...n}=e,{error:s,formItemId:i}=f();return(0,r.jsx)(o._,{ref:t,className:(0,l.cn)(s&&"text-destructive",a),htmlFor:i,...n})});x.displayName="FormLabel";let h=n.forwardRef((e,t)=>{let{...a}=e,{error:n,formItemId:i,formDescriptionId:l,formMessageId:o}=f();return(0,r.jsx)(s.g7,{ref:t,id:i,"aria-describedby":n?"".concat(l," ").concat(o):"".concat(l),"aria-invalid":!!n,...a})});h.displayName="FormControl",n.forwardRef((e,t)=>{let{className:a,...n}=e,{formDescriptionId:s}=f();return(0,r.jsx)("p",{ref:t,id:s,className:(0,l.cn)("text-sm text-muted-foreground",a),...n})}).displayName="FormDescription";let v=n.forwardRef((e,t)=>{var a;let{className:n,children:s,...i}=e,{error:o,formMessageId:d}=f(),c=o?String(null!==(a=null==o?void 0:o.message)&&void 0!==a?a:""):s;return c?(0,r.jsx)("p",{ref:t,id:d,className:(0,l.cn)("text-sm font-medium text-destructive",n),...i,children:c}):null});v.displayName="FormMessage"},40279:function(e,t,a){"use strict";a.d(t,{I:function(){return i}});var r=a(57437),n=a(2265),s=a(93448);let i=n.forwardRef((e,t)=>{let{className:a,type:n,...i}=e;return(0,r.jsx)("input",{type:n,className:(0,s.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:t,...i})});i.displayName="Input"},75060:function(e,t,a){"use strict";a.d(t,{_:function(){return d}});var r=a(57437),n=a(2265),s=a(6394),i=a(90535),l=a(93448);let o=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(s.f,{ref:t,className:(0,l.cn)(o(),a),...n})});d.displayName=s.f.displayName},12749:function(e,t,a){"use strict";a.d(t,{J2:function(){return l},xo:function(){return o},yk:function(){return d}});var r=a(57437),n=a(2265),s=a(27312),i=a(93448);let l=s.fC,o=s.xz,d=n.forwardRef((e,t)=>{let{className:a,align:n="center",sideOffset:l=4,...o}=e;return(0,r.jsx)(s.h_,{children:(0,r.jsx)(s.VY,{ref:t,align:n,sideOffset:l,className:(0,i.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...o})})});d.displayName=s.VY.displayName},90641:function(e,t,a){"use strict";a.d(t,{x:function(){return l}});var r=a(57437),n=a(2265),s=a(43643),i=a(93448);let l=n.forwardRef((e,t)=>{let{className:a,children:n,...l}=e;return(0,r.jsxs)(s.fC,{ref:t,className:(0,i.cn)("relative overflow-hidden",a),...l,children:[(0,r.jsx)(s.l_,{className:"h-full w-full rounded-[inherit]",children:n}),(0,r.jsx)(o,{}),(0,r.jsx)(s.Ns,{})]})});l.displayName=s.fC.displayName;let o=n.forwardRef((e,t)=>{let{className:a,orientation:n="vertical",...l}=e;return(0,r.jsx)(s.gb,{ref:t,orientation:n,className:(0,i.cn)("flex touch-none select-none transition-colors","vertical"===n&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===n&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),...l,children:(0,r.jsx)(s.q4,{className:"relative flex-1 rounded-full bg-border"})})});o.displayName=s.gb.displayName},31593:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});var r=a(57437),n=a(2265),s=a(55156),i=a(93448);let l=n.forwardRef((e,t)=>{let{className:a,orientation:n="horizontal",decorative:l=!0,...o}=e;return(0,r.jsx)(s.f,{ref:t,decorative:l,orientation:n,className:(0,i.cn)("shrink-0 bg-border","horizontal"===n?"h-[1px] w-full":"h-full w-[1px]",a),...o})});l.displayName=s.f.displayName},94589:function(e,t,a){"use strict";a.d(t,{r:function(){return l}});var r=a(57437),n=a(2265),s=a(50721),i=a(93448);let l=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(s.fC,{className:(0,i.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",a),...n,ref:t,children:(0,r.jsx)(s.bU,{className:(0,i.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});l.displayName=s.fC.displayName},23675:function(e,t,a){"use strict";a.d(t,{g:function(){return i}});var r=a(57437),n=a(2265),s=a(93448);let i=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("textarea",{className:(0,s.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:t,...n})});i.displayName="Textarea"},79684:function(e,t,a){"use strict";a.d(t,{R7:function(){return s},bG:function(){return n}}),a(83079);var r=a(12119);(0,r.$)("66a7e77381968e9347e32d9d375d0a488bb06bbb");var n=(0,r.$)("164e4611f07bc012094243de7aad1b85f88a7558"),s=(0,r.$)("080ba4c4ad92ec9d4477bc2807fa26292714577e")},22299:function(e,t,a){"use strict";a.d(t,{$1:function(){return s},JE:function(){return o},Ku:function(){return u},R7:function(){return v},RU:function(){return n},ec:function(){return x},g4:function(){return l},hD:function(){return c},k:function(){return m},kQ:function(){return f},qO:function(){return d},tY:function(){return i},vH:function(){return p},x3:function(){return h}}),a(83079);var r=a(12119),n=(0,r.$)("97ae364a62d4df2288a07a620d912ce0ac96b58c"),s=(0,r.$)("159b2fe09127c5bd3daae38e767205dac7d77cab"),i=(0,r.$)("def0aa2b8b4ea6c1e06bbb61a801cf9d7db8217f"),l=(0,r.$)("eb08ed1ec3e7601b9657c9104751f4cd16e193bf"),o=(0,r.$)("7ffaf3cdca4e8bfa88f07bb6fd67ea5a48706373"),d=(0,r.$)("4ba72153081d80db8eb0c1d6fd08c42be123a593"),c=(0,r.$)("862bc6f0e45e133730d43c165242b63549e8d6ef"),u=(0,r.$)("325dc1f7f655917be2c16c7e98b2d1937c654384"),f=(0,r.$)("627bffb6d24f861e176920b8fac8e87d263c0e39"),m=(0,r.$)("b436050b9f6ea9d78925f00d451d2f9caa7fe276"),p=(0,r.$)("87e287519cb1cf3861ceab331f0ef39f9649c540"),x=(0,r.$)("683f24dbc04449f1048d22803857dd2e140d0626");(0,r.$)("2b06f3a3c6bc1d56ad79fe0105b23730fc59fc3c");var h=(0,r.$)("68e7dcb5930b2f1144a87059acc32941a426a6ba");(0,r.$)("ffe6118251cbf259f053f1ac31bb9bf4df292901");var v=(0,r.$)("2f895fe1b49f74d13cc6d7f8c94cf7264d1a290d")},29114:function(e,t,a){"use strict";a.d(t,{gm:function(){return s}});var r=a(2265);a(57437);var n=r.createContext(void 0);function s(e){let t=r.useContext(n);return e||t||"ltr"}},6394:function(e,t,a){"use strict";a.d(t,{f:function(){return l}});var r=a(2265),n=a(66840),s=a(57437),i=r.forwardRef((e,t)=>(0,s.jsx)(n.WV.label,{...e,ref:t,onMouseDown:t=>{var a;t.target.closest("button, input, select, textarea")||(null===(a=e.onMouseDown)||void 0===a||a.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));i.displayName="Label";var l=i},6718:function(e,t,a){"use strict";a.d(t,{D:function(){return n}});var r=a(2265);function n(e){let t=r.useRef({value:e,previous:e});return r.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}},90420:function(e,t,a){"use strict";a.d(t,{t:function(){return s}});var r=a(2265),n=a(61188);function s(e){let[t,a]=r.useState(void 0);return(0,n.b)(()=>{if(e){a({width:e.offsetWidth,height:e.offsetHeight});let t=new ResizeObserver(t=>{let r,n;if(!Array.isArray(t)||!t.length)return;let s=t[0];if("borderBoxSize"in s){let e=s.borderBoxSize,t=Array.isArray(e)?e[0]:e;r=t.inlineSize,n=t.blockSize}else r=e.offsetWidth,n=e.offsetHeight;a({width:r,height:n})});return t.observe(e,{box:"border-box"}),()=>t.unobserve(e)}a(void 0)},[e]),t}}},function(e){e.O(0,[3609,9015,2522,2939,7514,3145,7648,9027,6239,2859,7845,9939,7213,4779,7626,803,2971,2117,1744],function(){return e(e.s=2427)}),_N_E=e.O()}]);