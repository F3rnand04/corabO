"use strict";exports.id=145,exports.ids=[145],exports.modules={40145:(e,s,a)=>{a.d(s,{L:()=>F});var l=a(10326),t=a(46226),r=a(24118),i=a(91664),n=a(3236),c=a(94019),o=a(69508),d=a(98091),m=a(29680),x=a(32933),h=a(40617),u=a(59593),f=a(687),j=a(69436),p=a(41190),N=a(3594),v=a(78062),g=a(13511),w=a(17577),b=a(481),C=a(86333),y=a(24230),z=a(51223);let k=w.createContext(null);function Z(){let e=w.useContext(k);if(!e)throw Error("useCarousel must be used within a <Carousel />");return e}let I=w.forwardRef(({orientation:e="horizontal",opts:s,setApi:a,plugins:t,className:r,children:i,...n},c)=>{let[o,d]=(0,b.Z)({...s,axis:"horizontal"===e?"x":"y"},t),[m,x]=w.useState(!1),[h,u]=w.useState(!1),f=w.useCallback(e=>{e&&(x(e.canScrollPrev()),u(e.canScrollNext()))},[]),j=w.useCallback(()=>{d?.scrollPrev()},[d]),p=w.useCallback(()=>{d?.scrollNext()},[d]),N=w.useCallback(e=>{"ArrowLeft"===e.key?(e.preventDefault(),j()):"ArrowRight"===e.key&&(e.preventDefault(),p())},[j,p]);return w.useEffect(()=>{d&&a&&a(d)},[d,a]),w.useEffect(()=>{if(d)return f(d),d.on("reInit",f),d.on("select",f),()=>{d?.off("select",f)}},[d,f]),l.jsx(k.Provider,{value:{carouselRef:o,api:d,opts:s,orientation:e,scrollPrev:j,scrollNext:p,canScrollPrev:m,canScrollNext:h},children:l.jsx("div",{ref:c,onKeyDownCapture:N,className:(0,z.cn)("relative",r),role:"region","aria-roledescription":"carousel",...n,children:i})})});I.displayName="Carousel";let S=w.forwardRef(({className:e,...s},a)=>{let{carouselRef:t,orientation:r}=Z();return l.jsx("div",{ref:t,className:"overflow-hidden",children:l.jsx("div",{ref:a,className:(0,z.cn)("flex","horizontal"===r?"-ml-4":"-mt-4 flex-col",e),...s})})});S.displayName="CarouselContent";let E=w.forwardRef(({className:e,...s},a)=>{let{orientation:t}=Z();return l.jsx("div",{ref:a,role:"group","aria-roledescription":"slide",className:(0,z.cn)("min-w-0 shrink-0 grow-0 basis-full","horizontal"===t?"pl-4":"pt-4",e),...s})});E.displayName="CarouselItem";let R=w.forwardRef(({className:e,variant:s="outline",size:a="icon",...t},r)=>{let{orientation:n,scrollPrev:c,canScrollPrev:o}=Z();return(0,l.jsxs)(i.z,{ref:r,variant:s,size:a,className:(0,z.cn)("absolute  h-8 w-8 rounded-full","horizontal"===n?"-left-12 top-1/2 -translate-y-1/2":"-top-12 left-1/2 -translate-x-1/2 rotate-90",e),disabled:!o,onClick:c,...t,children:[l.jsx(C.Z,{className:"h-4 w-4"}),l.jsx("span",{className:"sr-only",children:"Previous slide"})]})});R.displayName="CarouselPrevious";let A=w.forwardRef(({className:e,variant:s="outline",size:a="icon",...t},r)=>{let{orientation:n,scrollNext:c,canScrollNext:o}=Z();return(0,l.jsxs)(i.z,{ref:r,variant:s,size:a,className:(0,z.cn)("absolute h-8 w-8 rounded-full","horizontal"===n?"-right-12 top-1/2 -translate-y-1/2":"-bottom-12 left-1/2 -translate-x-1/2 rotate-90",e),disabled:!o,onClick:c,...t,children:[l.jsx(y.Z,{className:"h-4 w-4"}),l.jsx("span",{className:"sr-only",children:"Next slide"})]})});A.displayName="CarouselNext";var P=a(82015),D=a(80980);function F({isOpen:e,onOpenChange:s,gallery:a,startIndex:b=0,owner:C}){let{currentUser:y}=(0,g.a)(),[z,k]=(0,w.useState)(),[Z,F]=(0,w.useState)(b),[q,K]=(0,w.useState)(""),L=(0,w.useRef)(null),[$,Q]=(0,w.useState)(!1),[T,U]=(0,w.useState)(""),[V,G]=(0,w.useState)(null),[O,B]=(0,w.useState)(null),H=y?.id===C?.id,J=a[Z],M=()=>{q.trim()&&J&&C&&y&&((0,D.Ck)({ownerId:C.id,imageId:J.id,commentText:q,author:{id:y.id,name:y.name,profileImage:y.profileImage}}),K(""))},W=e=>{J&&C&&y&&(0,D.nd)({imageId:J.id,commentIndex:e,authorId:y.id})},X=e=>{C&&y&&((0,D.yT)(C.id,e),s(!1))};return a&&0!==a.length&&y?l.jsx(r.Vq,{open:e,onOpenChange:s,children:(0,l.jsxs)(r.cZ,{className:"max-w-4xl w-[95vw] h-[90vh] flex flex-col p-0 gap-0",children:[l.jsx(r.fK,{children:l.jsx(r.$N,{className:"sr-only",children:J?.alt})}),l.jsx(i.z,{variant:"ghost",size:"icon",onClick:()=>s(!1),className:"absolute top-2 right-2 z-50 bg-black/30 text-white hover:bg-black/50 hover:text-white rounded-full",children:l.jsx(c.Z,{className:"h-5 w-5"})}),l.jsx("div",{className:"w-full h-3/5 bg-black flex-shrink-0 relative",children:(0,l.jsxs)(I,{setApi:k,className:"w-full h-full",children:[l.jsx(S,{children:a.map((e,s)=>l.jsx(E,{children:l.jsx("div",{className:"w-full h-full relative",children:"video"===e.type?l.jsx("video",{src:e.src,className:"w-full h-full object-contain",controls:!0,autoPlay:!0,loop:!0}):l.jsx(t.default,{src:O||e.src,alt:e.alt,fill:!0,className:"object-contain","data-ai-hint":"product detail"})})},s))}),l.jsx(R,{className:"absolute left-4 top-1/2 -translate-y-1/2 z-10"}),l.jsx(A,{className:"absolute right-4 top-1/2 -translate-y-1/2 z-10"})]})}),l.jsx(n.x,{className:"flex-grow overflow-y-auto bg-background",children:J&&(0,l.jsxs)("div",{className:"p-6",children:[(0,l.jsxs)("div",{className:"flex justify-between items-start",children:[(0,l.jsxs)("div",{children:[l.jsx("h2",{className:"text-xl font-bold",children:J.alt}),(0,l.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:["Publicado por ",l.jsx("span",{className:"font-semibold text-foreground",children:C?.name})]})]}),H&&!$&&(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsxs)(i.z,{variant:"outline",size:"sm",onClick:()=>Q(!0),children:[l.jsx(o.Z,{className:"h-4 w-4 mr-2"}),"Editar"]}),(0,l.jsxs)(i.z,{variant:"destructive",size:"sm",onClick:()=>X(J.id),children:[l.jsx(d.Z,{className:"h-4 w-4 mr-2"}),"Eliminar"]})]})]}),$?(0,l.jsxs)("div",{className:"my-4 space-y-4",children:[l.jsx("input",{type:"file",ref:L,onChange:e=>{let s=e.target.files?.[0];if(s){G(s);let e=new FileReader;e.onloadend=()=>B(e.result),e.readAsDataURL(s)}},className:"hidden",accept:"image/*,video/*"}),(0,l.jsxs)(i.z,{variant:"outline",className:"w-full",onClick:()=>L.current?.click(),children:[l.jsx(m.Z,{className:"mr-2 h-4 w-4"}),"Cambiar Imagen o Video"]}),l.jsx(P.g,{value:T,onChange:e=>U(e.target.value),rows:4,placeholder:"Edita la descripci\xf3n..."}),(0,l.jsxs)("div",{className:"flex justify-end gap-2",children:[l.jsx(i.z,{variant:"ghost",onClick:()=>Q(!1),children:"Cancelar"}),(0,l.jsxs)(i.z,{onClick:()=>{J&&C&&((0,D.Fn)(J.id,{description:T,imageDataUri:O||void 0}),Q(!1))},children:[l.jsx(x.Z,{className:"mr-2 h-4 w-4"}),"Guardar Cambios"]})]})]}):l.jsx("p",{className:"text-sm text-foreground my-4",children:J.description}),l.jsx(v.Z,{}),(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[l.jsx(h.Z,{className:"w-5 h-5"}),"Comentarios (",J.comments?.length||0,")"]}),(0,l.jsxs)("div",{className:"space-y-4",children:[J.comments?.map((e,s)=>l.jsxs("div",{className:"flex items-start gap-3 group",children:[l.jsxs(N.qE,{className:"w-8 h-8 shrink-0",children:[l.jsx(N.F$,{src:e.profileImage,alt:e.author}),l.jsx(N.Q5,{children:e.author.charAt(0)})]}),l.jsxs("div",{className:"flex-grow",children:[l.jsx("p",{className:"font-semibold text-sm",children:e.author}),l.jsx("p",{className:"text-sm text-muted-foreground",children:e.text}),l.jsxs("div",{className:"flex items-center gap-2 mt-1 text-muted-foreground",children:[l.jsx(i.z,{variant:"ghost",size:"icon",className:"w-6 h-6",children:l.jsx(u.Z,{className:"w-4 h-4"})}),l.jsx("span",{className:"text-xs",children:0}),l.jsx(i.z,{variant:"ghost",size:"icon",className:"w-6 h-6",children:l.jsx(f.Z,{className:"w-4 h-4"})}),l.jsx("span",{className:"text-xs",children:0})]})]}),(e.authorId===y.id||H)&&l.jsx(i.z,{variant:"ghost",size:"icon",className:"w-7 h-7 shrink-0 opacity-0 group-hover:opacity-100",onClick:()=>W(s),children:l.jsx(d.Z,{className:"w-4 h-4 text-destructive"})})]},s)),!J.comments?.length&&l.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No hay comentarios a\xfan. \xa1S\xe9 el primero!"})]}),(0,l.jsxs)("div",{className:"mt-6 flex items-center gap-2",children:[(0,l.jsxs)(N.qE,{className:"w-8 h-8 shrink-0",children:[l.jsx(N.F$,{src:y.profileImage}),l.jsx(N.Q5,{children:y.name.charAt(0)})]}),l.jsx(p.I,{placeholder:"A\xf1ade un comentario...",value:q,onChange:e=>K(e.target.value),onKeyDown:e=>"Enter"===e.key&&M()}),l.jsx(i.z,{onClick:M,disabled:!q.trim(),size:"icon",children:l.jsx(j.Z,{className:"h-4 w-4"})})]})]})]})})]})}):null}}};