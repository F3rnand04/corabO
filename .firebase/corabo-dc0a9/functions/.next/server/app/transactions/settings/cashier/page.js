(()=>{var e={};e.id=3915,e.ids=[3915],e.modules={92509:e=>{"use strict";e.exports=require("firebase-admin")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},80665:e=>{"use strict";e.exports=require("dns")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},35816:e=>{"use strict";e.exports=require("process")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},3263:e=>{"use strict";e.exports=import("firebase-admin/app")},72929:e=>{"use strict";e.exports=import("firebase-admin/firestore")},68116:e=>{"use strict";e.exports=import("firebase-admin/storage")},48101:(e,s,a)=>{"use strict";a.r(s),a.d(s,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>x,pages:()=>o,routeModule:()=>h,tree:()=>d}),a(48956),a(70149),a(96765),a(75625),a(14205),a(12523);var t=a(23191),r=a(88716),i=a(37922),n=a.n(i),l=a(95231),c={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);a.d(s,c);let d=["",{children:["transactions",{children:["settings",{children:["cashier",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,48956)),"/home/user/corabO/src/app/transactions/settings/cashier/page.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,70149)),"/home/user/corabO/src/app/transactions/settings/cashier/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,96765)),"/home/user/corabO/src/app/transactions/settings/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,75625)),"/home/user/corabO/src/app/transactions/layout.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(a.bind(a,14205)),"/home/user/corabO/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.bind(a,12523)),"/home/user/corabO/src/app/not-found.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],o=["/home/user/corabO/src/app/transactions/settings/cashier/page.tsx"],x="/transactions/settings/cashier/page",u={require:a,loadChunk:()=>Promise.resolve()},h=new t.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/transactions/settings/cashier/page",pathname:"/transactions/settings/cashier",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},80151:(e,s,a)=>{Promise.resolve().then(a.bind(a,34323))},35303:()=>{},24230:(e,s,a)=>{"use strict";a.d(s,{Z:()=>t});let t=(0,a(62881).Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},91216:(e,s,a)=>{"use strict";a.d(s,{Z:()=>t});let t=(0,a(62881).Z)("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]])},12714:(e,s,a)=>{"use strict";a.d(s,{Z:()=>t});let t=(0,a(62881).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},98091:(e,s,a)=>{"use strict";a.d(s,{Z:()=>t});let t=(0,a(62881).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},34323:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>D});var t=a(10326),r=a(17577),i=a(91664),n=a(29752),l=a(11890),c=a(50699),d=a(95920),o=a(98091),x=a(91216),u=a(12714),h=a(36283),m=a(62881);let p=(0,m.Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var j=a(92447),g=a(35047),f=a(13511),v=a(55296),b=a(41190),y=a(24230),N=a(86645),w=a(16671),k=a(77506);let C=(0,m.Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);var q=a(84097),z=a(39642),A=a(97885),Z=a(46226);let E=({boxName:e,businessId:s,qrValue:a,onClose:n})=>{let{toast:l}=(0,q.pm)(),[c,d]=(0,r.useState)(!1),o=(0,r.useRef)(null),x="https://i.postimg.cc/YSNBv5DT/logo-light-png.png",u=(0,r.useCallback)(()=>{if(!o.current){l({variant:"destructive",title:"Error",description:"No se puede encontrar el contenido para descargar."});return}d(!0),(0,z.default)(o.current,{useCORS:!0,logging:!1}).then(s=>{let a=document.createElement("a");a.download=`QR-Caja-${e.replace(/\s+/g,"-")}.png`,a.href=s.toDataURL("image/png"),a.click(),l({title:"Descarga Iniciada",description:"Tu c\xf3digo QR se est\xe1 descargando."}),d(!1),n()}).catch(e=>{console.error("Error al descargar el canvas:",e),l({variant:"destructive",title:"Error de Descarga",description:"No se pudo generar el PNG."}),d(!1),n()})},[e,n,l]);return(0,t.jsxs)(t.Fragment,{children:[t.jsx("div",{className:"absolute -left-[9999px] top-0",children:(0,t.jsxs)("div",{ref:o,id:"printable-qr-area",className:"bg-[#E3F2FD] p-12 rounded-2xl text-center flex flex-col justify-between",style:{width:"825px",height:"1275px"},children:[(0,t.jsxs)("div",{className:"flex-shrink-0 flex flex-col items-center justify-center pt-8",children:[t.jsx("h2",{className:"text-4xl font-bold text-[#1E3A8A] mb-4",children:"Escanea y paga a tu ritmo con"}),t.jsx("div",{className:"relative w-72 h-24",children:t.jsx(Z.default,{src:x,alt:"Corabo Logo",layout:"fill",objectFit:"contain",unoptimized:!0})})]}),t.jsx("div",{className:"flex justify-center items-center my-8 flex-grow",children:t.jsx("div",{className:"bg-white p-6 rounded-xl shadow-md",children:t.jsx(A.tv,{value:a,size:300})})}),(0,t.jsxs)("div",{className:"flex-shrink-0 pb-8",children:[t.jsx("h2",{className:"text-5xl font-bold text-[#1E3A8A] mt-4",children:"Compra lo que amas."}),(0,t.jsxs)("div",{className:"flex justify-around items-center text-[#1E3A8A] my-12",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[t.jsx(j.Z,{className:"w-12 h-12"}),t.jsx("span",{className:"text-xl font-semibold",children:"Escanea"})]}),t.jsx(y.Z,{className:"w-10 h-10 text-gray-400"}),(0,t.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[t.jsx(N.Z,{className:"w-12 h-12"}),t.jsx("span",{className:"text-xl font-semibold",children:"Autoriza"})]}),t.jsx(y.Z,{className:"w-10 h-10 text-gray-400"}),(0,t.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[t.jsx(w.Z,{className:"w-12 h-12"}),t.jsx("span",{className:"text-xl font-semibold",children:"Paga"})]})]}),t.jsx("div",{className:"w-full border-b-4 border-dashed border-gray-400 my-8"}),(0,t.jsxs)("div",{className:"text-2xl font-semibold text-[#1E3A8A]",children:[(0,t.jsxs)("p",{children:["Caja: ",e]}),(0,t.jsxs)("p",{children:["ID Negocio: ",s]})]})]})]})}),(0,t.jsxs)("div",{className:"flex flex-col items-center gap-4 bg-background p-4 rounded-lg shadow-lg w-full",children:[t.jsx("h3",{className:"font-bold text-lg text-center",children:"Vista Previa de Impresi\xf3n"}),(0,t.jsxs)("div",{className:"bg-[#E3F2FD] p-4 rounded-lg text-center w-full max-w-sm",children:[t.jsx("h2",{className:"text-md font-semibold text-[#1E3A8A] mb-2",children:"Escanea y paga a tu ritmo con"}),t.jsx("div",{className:"relative w-2/3 mx-auto mb-2 aspect-[3/1]",children:t.jsx(Z.default,{src:x,alt:"Corabo Logo",layout:"fill",objectFit:"contain",unoptimized:!0})}),t.jsx("div",{className:"flex justify-center items-center my-4",children:t.jsx("div",{className:"bg-white p-2 rounded-md shadow-sm",children:t.jsx(A.tv,{value:a,size:128})})}),t.jsx("p",{className:"text-xl font-bold text-[#1E3A8A] mt-2",children:"Compra lo que amas."}),(0,t.jsxs)("div",{className:"mt-4 pt-2 border-t border-blue-200 text-xs font-semibold text-[#1E3A8A]",children:[(0,t.jsxs)("p",{children:["Caja: ",e]}),(0,t.jsxs)("p",{children:["ID Negocio: ",s]})]})]}),(0,t.jsxs)(v.xo,{className:"sm:justify-between w-full mt-4",children:[t.jsx(v.le,{onClick:n,children:"Cerrar"}),(0,t.jsxs)(i.z,{onClick:u,disabled:c,children:[c?t.jsx(k.Z,{className:"mr-2 h-4 w-4 animate-spin"}):t.jsx(C,{className:"mr-2 h-4 w-4"}),c?"Generando...":"Descargar Media Carta"]})]})]})]})};var P=a(90434),R=a(51223),_=a(38443),M=a(11604);function O(){let e=(0,g.useRouter)();return t.jsx("header",{className:"sticky top-0 z-30 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 border-b",children:t.jsx("div",{className:"container px-4 sm:px-6",children:(0,t.jsxs)("div",{className:"flex h-16 items-center justify-between",children:[t.jsx(i.z,{variant:"ghost",size:"icon",onClick:()=>e.push("/transactions/settings"),children:t.jsx(l.Z,{className:"h-6 w-6"})}),(0,t.jsxs)("h1",{className:"text-lg font-semibold flex items-center gap-2",children:[t.jsx(c.Z,{className:"w-5 h-5"})," Gesti\xf3n de Cajas"]}),t.jsx(i.z,{asChild:!0,variant:"ghost",size:"icon",children:t.jsx(P.default,{href:"/",children:t.jsx(d.Z,{className:"h-5 h-5"})})})]})})})}function S(){let{currentUser:e,qrSession:s}=(0,f.a)(),[a,l]=(0,r.useState)(""),[c,d]=(0,r.useState)(""),[m,g]=(0,r.useState)(null),[y,N]=(0,r.useState)({}),[w,k]=(0,r.useState)({}),[C,q]=(0,r.useState)(null),z=async()=>{a&&c&&e&&(q("new"),await (0,M.cN)(e.id,a,c),l(""),d(""),q(null))},A=(e,s)=>{k(a=>({...a,[e]:s}))},Z=async s=>{let a=w[s];a&&e&&(q(s),await (0,M.zt)(e.id,s,{passwordHash:a}),k(e=>{let a={...e};return delete a[s],a}),q(null))},O=async s=>{e&&(q(s),await (0,M.jh)(e.id,s),q(null))},S=async s=>{e&&(q(s),await (0,M.QN)(e.id,s),q(null))},D=e=>{N(s=>({...s,[e]:!s[e]}))};if(!e||e.profileSetupData?.providerType!=="company")return t.jsx("p",{children:"Esta funci\xf3n solo est\xe1 disponible para cuentas de empresa."});let T=e?.profileSetupData?.cashierBoxes||[];return(0,t.jsxs)(n.Zb,{children:[(0,t.jsxs)(n.Ol,{children:[t.jsx(n.ll,{children:"Administrar Puntos de Venta"}),t.jsx(n.SZ,{children:"Crea y gestiona los puntos de venta para tu negocio. Cada caja tendr\xe1 su propio QR de pago y contrase\xf1a."})]}),(0,t.jsxs)(n.aY,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2 p-3 border rounded-lg bg-background",children:[t.jsx("h4",{className:"text-sm font-semibold",children:"A\xf1adir Nueva Caja"}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[t.jsx(b.I,{placeholder:"Nombre de la caja (ej: Barra)",value:a,onChange:e=>l(e.target.value),disabled:"new"===C}),t.jsx(b.I,{type:"text",placeholder:"Contrase\xf1a num\xe9rica (4-6 d\xedgitos)",value:c,onChange:e=>d(e.target.value),maxLength:6,disabled:"new"===C}),t.jsx(i.z,{onClick:z,disabled:"new"===C||!a||!c||T.length>=5,children:"new"===C?"Creando...":"A\xf1adir"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx("h4",{className:"text-sm font-semibold",children:"Cajas Activas"}),T.length>0?t.jsx("div",{className:"space-y-2",children:T.map(a=>{let r=s?.cashierBoxId===a.id;return(0,t.jsxs)("div",{className:(0,R.cn)("flex flex-col gap-3 p-3 bg-background rounded-md border",r&&"border-green-500 ring-1 ring-green-500"),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx("p",{className:"font-medium flex-shrink-0",children:a.name}),r&&t.jsx(_.C,{variant:"default",className:"bg-green-500 hover:bg-green-600",children:"Activa"})]}),(0,t.jsxs)(v.aR,{children:[t.jsx(v.vW,{asChild:!0,children:t.jsx(i.z,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive",disabled:C===a.id,children:t.jsx(o.Z,{className:"w-4 h-4"})})}),(0,t.jsxs)(v._T,{children:[(0,t.jsxs)(v.fY,{children:[(0,t.jsxs)(v.f$,{children:['\xbfEliminar la caja "',a.name,'"?']}),t.jsx(v.yT,{children:"Esta acci\xf3n es permanente y no se puede deshacer."})]}),(0,t.jsxs)(v.xo,{children:[t.jsx(v.le,{children:"Cancelar"}),t.jsx(v.OL,{onClick:()=>S(a.id),children:"S\xed, eliminar"})]})]})]})]}),(0,t.jsxs)("div",{className:"flex-grow flex items-center gap-2",children:[(0,t.jsxs)("div",{className:"relative w-full",children:[t.jsx(b.I,{type:y[a.id]?"text":"password",defaultValue:a.passwordHash,onChange:e=>A(a.id,e.target.value),className:"pr-10"}),t.jsx(i.z,{variant:"ghost",size:"icon",className:"absolute right-1 top-1/2 -translate-y-1/2 h-8 w-8",onClick:()=>D(a.id),children:y[a.id]?t.jsx(x.Z,{className:"w-4 h-4"}):t.jsx(u.Z,{className:"w-4 h-4"})})]}),t.jsx(i.z,{size:"sm",onClick:()=>Z(a.id),disabled:!w[a.id]||C===a.id,children:"Guardar"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1 justify-end flex-wrap",children:[t.jsx(i.z,{asChild:!0,variant:"outline",size:"sm",children:(0,t.jsxs)(P.default,{href:`/transactions/settings/cashier/${a.id}`,children:[t.jsx(h.Z,{className:"w-4 h-4 mr-2"}),"Detalles"]})}),(0,t.jsxs)(v.aR,{children:[t.jsx(v.vW,{asChild:!0,children:(0,t.jsxs)(i.z,{variant:"outline",size:"sm",disabled:C===a.id,children:[C===a.id?t.jsx(p,{className:"w-4 h-4 animate-spin"}):t.jsx(p,{className:"w-4 h-4 mr-2"}),C!==a.id&&"Nuevo QR"]})}),(0,t.jsxs)(v._T,{children:[(0,t.jsxs)(v.fY,{children:[(0,t.jsxs)(v.f$,{children:['\xbfGenerar nuevo QR para "',a.name,'"?']}),t.jsx(v.yT,{children:"Esta acci\xf3n invalidar\xe1 el c\xf3digo QR anterior. Aseg\xfarate de reemplazar cualquier QR f\xedsico que est\xe9s usando."})]}),(0,t.jsxs)(v.xo,{children:[t.jsx(v.le,{children:"Cancelar"}),t.jsx(v.OL,{onClick:()=>O(a.id),children:"S\xed, generar nuevo QR"})]})]})]}),(0,t.jsxs)(i.z,{variant:"outline",size:"sm",onClick:()=>g({id:a.id,name:a.name,businessId:e.coraboId||e.id,qrValue:a.qrValue}),children:[t.jsx(j.Z,{className:"w-4 h-4 mr-2"}),"Ver QR"]})]})]},a.id)})}):t.jsx("p",{className:"text-xs text-muted-foreground text-center py-4",children:"A\xfan no has creado ninguna caja."})]})]}),t.jsx(v.aR,{open:!!m,onOpenChange:e=>!e&&g(null),children:t.jsx(v._T,{className:"max-w-md p-0 bg-transparent border-none shadow-none",children:m&&t.jsx(E,{boxName:m.name,businessId:m.businessId,qrValue:m.qrValue,onClose:()=>g(null)})})})]})}function D(){return(0,t.jsxs)(t.Fragment,{children:[t.jsx(O,{}),t.jsx("main",{className:"container py-8 max-w-2xl mx-auto space-y-8",children:t.jsx(S,{})})]})}},75625:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>i,metadata:()=>r});var t=a(19510);let r={title:"Registro de Transacciones - Corabo",description:"Tu centro de control financiero."};function i({children:e}){return t.jsx(t.Fragment,{children:e})}},70149:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>i,metadata:()=>r});var t=a(19510);let r={title:"Gesti\xf3n de Cajas - Corabo",description:"Crea y administra tus puntos de venta."};function i({children:e}){return t.jsx("div",{className:"bg-muted/30 min-h-screen",children:e})}},48956:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>t});let t=(0,a(68570).createProxy)(String.raw`/home/user/corabO/src/app/transactions/settings/cashier/page.tsx#default`)},96765:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>i,metadata:()=>r});var t=a(19510);let r={title:"Ajustes de Transacciones - Corabo",description:"Configura tu m\xf3dulo de transacciones."};function i({children:e}){return t.jsx("div",{className:"bg-muted/30 min-h-screen",children:e})}}};var s=require("../../../../webpack-runtime.js");s.C(e);var a=e=>s(s.s=e),t=s.X(0,[8948,8786,2791,8465,5738,2687,2784],()=>a(48101));module.exports=t})();